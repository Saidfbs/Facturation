<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø­Ø§Ø³Ø¨Ø© ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ© Ù…ØªÙƒØ§Ù…Ù„Ø© - Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ù…Ø­Ø³Ù†</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --main-color: #004e92;
            --accent-color: #000428;
            --background: #f1f4f9;
            --white: #ffffff;
            --border-radius: 12px;
            --error-color: #e63946;
            --success-color: #2a9d8f;
        }

        body {
            font-family: 'Cairo', sans-serif;
            background-color: var(--background);
            margin: 0;
            padding: 20px;
            line-height: 1.6;
            direction: rtl;
            text-align: right;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            box-sizing: border-box;
        }

        .container {
            max-width: 900px;
            width: 100%;
            background-color: var(--white);
            padding: 25px;
            border-radius: var(--border-radius);
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
            margin: 0;
            max-height: calc(100vh - 40px);
            overflow-y: auto;
            box-sizing: border-box;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--main-color);
            width: 100%;
            flex-shrink: 0;
        }

        .header h1 {
            color: var(--main-color);
            margin-bottom: 10px;
        }

        .section {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-grow: 1;
            flex-basis: calc(33.33% - 13.33px); /* 3 Ø£Ø¹Ù…Ø¯Ø© Ù…Ø¹ Ø­Ø³Ø§Ø¨ Ø§Ù„ÙØ¬ÙˆØ© */
            max-width: calc(33.33% - 13.33px);
            margin-bottom: 0;
        }
        
        h2 {
            background: linear-gradient(to left, var(--main-color), var(--accent-color));
            color: var(--white);
            padding: 15px;
            border-radius: var(--border-radius);
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            user-select: none;
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 8px;
            width: 100%; /* Ù„Ù…Ù„Ø¡ Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ù…Ø®ØµØµØ© ÙÙŠ .section */
            height: 180px; /* Ø§Ø±ØªÙØ§Ø¹ Ø«Ø§Ø¨Øª Ù„Ø¬Ø¹Ù„ Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ù…Ø±Ø¨Ø¹Ø© */
            box-sizing: border-box;
            font-size: 1.1em;
            font-weight: 600;
        }

        h2 .icon {
            font-size: 2.5em;
            margin-bottom: 5px;
            line-height: 1;
        }

        h2 .text {
            font-size: 0.85em;
            line-height: 1.2;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        h2:hover {
            opacity: 0.9;
            transform: translateY(-2px);
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(5px);
            justify-content: center;
            align-items: center;
            animation: fadeInModal 0.3s ease-out;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background-color: var(--white);
            margin: auto;
            padding: 30px;
            border-radius: var(--border-radius);
            box-shadow: 0 5px 25px rgba(0, 0, 0, 0.2);
            width: 90%;
            max-width: 600px;
            position: relative;
            animation: slideIn 0.3s ease-out;
            max-height: 90vh;
            overflow-y: auto;
        }

        .close-button {
            color: #aaa;
            font-size: 28px;
            font-weight: bold;
            position: absolute;
            top: 10px;
            left: 15px;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .close-button:hover,
        .close-button:focus {
            color: var(--error-color);
            text-decoration: none;
            cursor: pointer;
        }

        @keyframes fadeInModal {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideIn {
            from { transform: translateY(-30px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .calculator {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
            margin-top: 10px;
            padding: 0;
            background-color: transparent;
            border-radius: 0;
            border: none;
            animation: none;
        }

        .calculator-description {
            background-color: #e7f3ff;
            padding: 10px 15px;
            border-radius: var(--border-radius);
            margin-bottom: 15px;
            font-size: 0.9em;
            border-right: 3px solid var(--main-color);
        }

        .input-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .input-group label {
            font-weight: 600;
            color: var(--main-color);
        }

        .calculator input,
        .calculator select,
        .calculator button {
            padding: 12px;
            font-size: 1em;
            width: 100%;
            border: 1px solid #ccc;
            border-radius: var(--border-radius);
            box-sizing: border-box;
            font-family: 'Cairo', sans-serif;
            transition: all 0.2s ease;
            text-align: right;
        }

        .calculator input:focus,
        .calculator select:focus {
            border-color: var(--main-color);
            box-shadow: 0 0 0 2px rgba(0, 78, 146, 0.2);
            outline: none;
        }

        .calculator input.error {
            border-color: var(--error-color);
        }

        button {
            background-color: var(--main-color);
            color: var(--white);
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        button:hover {
            background-color: var(--accent-color);
            transform: translateY(-2px);
        }

        button:active {
            transform: translateY(0);
        }

        .result {
            background-color: #e7f3ff;
            padding: 15px;
            border-radius: var(--border-radius);
            font-weight: bold;
            margin-top: 10px;
            text-align: right;
            font-size: 1.1em;
            border-left: 4px solid var(--main-color);
        }

        .result ul {
            list-style: none;
            padding: 0;
            margin: 10px 0;
        }

        .result ul li {
            margin-bottom: 8px;
            padding-right: 15px;
            position: relative;
            font-weight: normal;
            font-size: 0.95em;
        }

        .result ul li::before {
            content: "â€¢";
            color: var(--main-color);
            position: absolute;
            right: 0;
            top: 0;
            font-size: 1.2em;
            line-height: 1.4;
        }

        .result.success {
            background-color: #e8f8f6;
            border-left-color: var(--success-color);
        }

        .result.error {
            background-color: #fee8e9;
            border-left-color: var(--error-color);
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, .3);
            border-radius: 50%;
            border-top-color: var(--white);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }


    </style>
</head>
<body>

    <div class="container">
        <div class="header">
            <h1>âš¡ Ø§Ù„Ø­Ø§Ø³Ø¨Ø© Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ© Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„Ø©</h1>
            <p>Ø£Ø¯Ø§Ø© Ù…ØªÙƒØ§Ù…Ù„Ø© Ù„Ø­Ù„ Ø¬Ù…ÙŠØ¹ Ø­Ø³Ø§Ø¨Ø§ØªÙƒ Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ© ÙˆØ§Ù„Ù‡Ù†Ø¯Ø³ÙŠØ©</p>
        </div>

        <div class="section">
            <h2 class="section-title" data-modal-target="modal-percentage-calculator">
                <span class="icon">ğŸ“Š</span>
                <span class="text">Ø­Ø³Ø§Ø¨ Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø¦ÙˆÙŠØ©</span>
            </h2>
            <div id="modal-percentage-calculator" class="modal">
                <div class="modal-content">
                    <span class="close-button">&times;</span>
                    <h2>ğŸ“Š Ø­Ø³Ø§Ø¨ Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø¦ÙˆÙŠØ©</h2>
                    <div class="calculator" id="percentage-calculator">
                        <div class="calculator-description">
                            Ø­Ø³Ø§Ø¨ Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø¦ÙˆÙŠØ© Ù„Ù‚ÙŠÙ…Ø© Ù…Ø¹ÙŠÙ†Ø© Ù…Ù† Ø¹Ø¯Ø¯ Ø£ØµÙ„ÙŠ.
                        </div>
                        <div class="input-group">
                            <label for="original-number">Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ø£ØµÙ„ÙŠ</label>
                            <input type="number" id="original-number" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ø£ØµÙ„ÙŠ" min="0">
                        </div>
                        <div class="input-group">
                            <label for="percentage-value">Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø¦ÙˆÙŠØ© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© (%)</label>
                            <input type="number" id="percentage-value" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø¦ÙˆÙŠØ©" min="0" max="100">
                        </div>
                        <button id="calculate-percentage-btn">Ø§Ø­Ø³Ø¨ Ø§Ù„Ù†Ø§ØªØ¬</button>
                        <div class="result" id="percentage-result">Ø§Ù„Ù†Ø§ØªØ¬: ...</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="section">
            <h2 class="section-title" data-modal-target="modal-unit-converter">
                <span class="icon">ğŸ”Œ</span>
                <span class="text">Ù…Ø­ÙˆÙ„ Ø§Ù„ÙˆØ­Ø¯Ø§Øª Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ©</span>
            </h2>
            <div id="modal-unit-converter" class="modal">
                <div class="modal-content">
                    <span class="close-button">&times;</span>
                    <h2>ğŸ”Œ Ù…Ø­ÙˆÙ„ Ø§Ù„ÙˆØ­Ø¯Ø§Øª Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ©</h2>
                    <div class="calculator" id="unit-converter">
                        <div class="calculator-description">
                            Ø£Ø¯Ø®Ù„ Ù‚ÙŠÙ…Ø© Ø¨ÙˆØ­Ø¯Ø© Ù…Ø¹ÙŠÙ†Ø© (ÙƒÙŠÙ„ÙˆÙˆØ§Ø·ØŒ ÙƒÙŠÙ„Ùˆ ÙÙˆÙ„Øª Ø£Ù…Ø¨ÙŠØ±ØŒ Ø­ØµØ§Ù†ØŒ Ø£Ùˆ Ø£Ù…Ø¨ÙŠØ±) Ù…Ø¹ Ø§Ù„Ø¬Ù‡Ø¯ØŒ Ø§Ù„Ø·ÙˆØ±ØŒ ÙˆÙ…Ø¹Ø§Ù…Ù„
                            Ø§Ù„Ù‚Ø¯Ø±Ø©ØŒ ÙˆØ³Ù†Ù‚ÙˆÙ… Ø¨ØªØ­ÙˆÙŠÙ„Ù‡Ø§ Ø¥Ù„Ù‰ Ø§Ù„ÙˆØ­Ø¯Ø§Øª Ø§Ù„Ø£Ø®Ø±Ù‰.
                        </div>
                        <div class="input-group">
                            <label for="uc-voltage">Ø§Ù„Ø¬Ù‡Ø¯ (V)</label>
                            <input type="number" id="uc-voltage" placeholder="Ù…Ø«Ø§Ù„: 230 Ø£Ùˆ 400" min="1">
                        </div>
                        <div class="input-group">
                            <label for="uc-phase">Ø§Ù„Ø·ÙˆØ±</label>
                            <select id="uc-phase">
                                <option value="single">Ø£Ø­Ø§Ø¯ÙŠ Ø§Ù„Ø·ÙˆØ±</option>
                                <option value="three">Ø«Ù„Ø§Ø«ÙŠ Ø§Ù„Ø·ÙˆØ±</option>
                            </select>
                        </div>
                        <div class="input-group">
                            <label for="uc-power-factor">Ù…Ø¹Ø§Ù…Ù„ Ø§Ù„Ù‚Ø¯Ø±Ø© (cos Ï†)</label>
                            <input type="number" id="uc-power-factor" value="0.8" step="0.01" min="0.1" max="1"
                                placeholder="Ù…Ø«Ø§Ù„: 0.8">
                        </div>
                        <div class="input-group">
                            <label for="uc-input-value">Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¯Ø®Ù„Ø©</label>
                            <input type="number" id="uc-input-value" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ù‚ÙŠÙ…Ø©" min="0">
                        </div>
                        <div class="input-group">
                            <label for="uc-input-unit">ÙˆØ­Ø¯Ø© Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¯Ø®Ù„Ø©</label>
                            <select id="uc-input-unit">
                                <option value="kw">ÙƒÙŠÙ„ÙˆÙˆØ§Ø· (kW)</option>
                                <option value="kva">ÙƒÙŠÙ„Ùˆ ÙÙˆÙ„Øª Ø£Ù…Ø¨ÙŠØ± (kVA)</option>
                                <option value="hp">Ø­ØµØ§Ù† (HP)</option>
                                <option value="amp">Ø£Ù…Ø¨ÙŠØ± (Amp)</option>
                            </select>
                        </div>
                        <button id="convert-unit-btn">ØªØ­ÙˆÙŠÙ„</button>
                        <div class="result" id="uc-result">
                            <p>Ø§Ù„Ù†ØªØ§Ø¦Ø¬: ...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="section">
            <h2 class="section-title" data-modal-target="modal-solar-panels">
                <span class="icon">â˜€ï¸</span>
                <span class="text">Ø­Ø³Ø§Ø¨ Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ù„ÙˆØ§Ø­ Ø§Ù„Ø´Ù…Ø³ÙŠØ© Ù„Ù…Ø¶Ø®Ø©</span>
            </h2>
            <div id="modal-solar-panels" class="modal">
                <div class="modal-content">
                    <span class="close-button">&times;</span>
                    <h2>â˜€ï¸ Ø­Ø³Ø§Ø¨ Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ù„ÙˆØ§Ø­ Ø§Ù„Ø´Ù…Ø³ÙŠØ© Ù„Ù…Ø¶Ø®Ø©</h2>
                    <div class="calculator" id="solar-panels-calculator">
                        <div class="calculator-description">
                            Ø­Ø³Ø§Ø¨ Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ù„ÙˆØ§Ø­ Ø§Ù„Ø´Ù…Ø³ÙŠØ© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù„ØªØ´ØºÙŠÙ„ Ù…Ø¶Ø®Ø© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ù‚Ø¯Ø±ØªÙ‡Ø§ Ø¨Ø§Ù„ÙƒÙŠÙ„ÙˆÙˆØ§Ø·ØŒ Ù…Ø¹ Ø§Ù„Ø£Ø®Ø° ÙÙŠ Ø§Ù„Ø§Ø¹ØªØ¨Ø§Ø± Ø¬Ù‡Ø¯ Ùˆ Ø·ÙˆØ± Ø§Ù„Ù…Ø¶Ø®Ø© (Ù„Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª)ØŒ Ùˆ Ù…Ø¹Ø§Ù…Ù„ Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø£Ù„ÙˆØ§Ø­ ÙˆÙƒÙØ§Ø¡Ø© Ø§Ù„Ù…Ø­ÙˆÙ„.
                        </div>
                        <div class="input-group">
                            <label for="pump-voltage">Ø¬Ù‡Ø¯ Ø§Ù„Ù…Ø¶Ø®Ø© (V)</label>
                            <input type="number" id="pump-voltage" placeholder="Ø¬Ù‡Ø¯ Ø§Ù„Ù…Ø¶Ø®Ø© Ø¨Ø§Ù„ÙÙˆÙ„Øª" min="1">
                        </div>
                        <div class="input-group">
                            <label for="pump-power-kw">Ù‚Ø¯Ø±Ø© Ø§Ù„Ù…Ø¶Ø®Ø© (kW)</label>
                            <input type="number" id="pump-power-kw" placeholder="Ø£Ø¯Ø®Ù„ Ù‚Ø¯Ø±Ø© Ø§Ù„Ù…Ø¶Ø®Ø© Ø¨Ø§Ù„ÙƒÙŠÙ„ÙˆÙˆØ§Ø·" min="0.1">
                        </div>
                        <div class="input-group">
                            <label for="pump-phase">Ø·ÙˆØ± Ø§Ù„Ù…Ø¶Ø®Ø©</label>
                            <select id="pump-phase">
                                <option value="single">Ø£Ø­Ø§Ø¯ÙŠ Ø§Ù„Ø·ÙˆØ±</option>
                                <option value="three">Ø«Ù„Ø§Ø«ÙŠ Ø§Ù„Ø·ÙˆØ±</option>
                            </select>
                        </div>
                        <div class="input-group">
                            <label for="pump-power-factor">Ù…Ø¹Ø§Ù…Ù„ Ù‚Ø¯Ø±Ø© Ø§Ù„Ù…Ø¶Ø®Ø© (cos Ï†)</label>
                            <input type="number" id="pump-power-factor" value="0.8" step="0.01" min="0.1" max="1" placeholder="Ù…Ø«Ø§Ù„: 0.8">
                        </div>
                        <div class="input-group">
                            <label for="panel-voltage">Ø¬Ù‡Ø¯ Ø§Ù„Ù„ÙˆØ­ Ø§Ù„Ø´Ù…Ø³ÙŠ (Vmp)</label>
                            <input type="number" id="panel-voltage" placeholder="Ø¬Ù‡Ø¯ Ø§Ù„Ù„ÙˆØ­ Ø¨Ø§Ù„ÙÙˆÙ„Øª" min="1">
                        </div>
                        <div class="input-group">
                            <label for="panel-current">ØªÙŠØ§Ø± Ø§Ù„Ù„ÙˆØ­ Ø§Ù„Ø´Ù…Ø³ÙŠ (Imp)</label>
                            <input type="number" id="panel-current" placeholder="ØªÙŠØ§Ø± Ø§Ù„Ù„ÙˆØ­ Ø¨Ø§Ù„Ø£Ù…Ø¨ÙŠØ±" min="0.1">
                        </div>
                        <div class="input-group">
                            <label for="solar-performance-factor">Ø¹Ø§Ù…Ù„ Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø£Ù„ÙˆØ§Ø­ (%)</label>
                            <input type="number" id="solar-performance-factor" value="80" min="50" max="100" step="1"
                                placeholder="Ù…Ø«Ø§Ù„: 80 (80%)">
                        </div>
                        <div class="input-group">
                            <label for="inverter-efficiency">ÙƒÙØ§Ø¡Ø© Ø§Ù„Ù…Ø­ÙˆÙ„ (Inverter Efficiency %)</label>
                            <input type="number" id="inverter-efficiency" value="90" min="50" max="100" step="1"
                                placeholder="Ù…Ø«Ø§Ù„: 90 (90%)">
                        </div>
                        <div class="input-group">
                            <label for="ideal-series-voltage">Ø§Ù„ØªÙˆØªØ± Ø§Ù„Ù…Ø«Ø§Ù„ÙŠ Ù„Ù„Ø£Ù„ÙˆØ§Ø­ Ø¹Ù„Ù‰ Ø§Ù„ØªÙˆØ§Ù„ÙŠ (V)</label>
                            <input type="number" id="ideal-series-voltage" placeholder="Ù…Ø«Ø§Ù„: 300V" min="1">
                        </div>
                        <button id="calculate-solar-panels-btn">Ø§Ø­Ø³Ø¨ Ø§Ù„Ø£Ù„ÙˆØ§Ø­</button>
                        <div class="result" id="solar-panels-result">Ø§Ù„Ù†ØªØ§Ø¦Ø¬: ...</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="section">
            <h2 class="section-title" data-modal-target="modal-pulley-calculator">
                <span class="icon">âš™ï¸</span>
                <span class="text">Ø­Ø³Ø§Ø¨ Ø³Ø±Ø¹Ø© Ø£Ùˆ Ù‚Ø·Ø± Ø§Ù„Ø¨ÙƒØ±Ø©</span>
            </h2>
            <div id="modal-pulley-calculator" class="modal">
                <div class="modal-content">
                    <span class="close-button">&times;</span>
                    <h2>âš™ï¸ Ø­Ø³Ø§Ø¨ Ø³Ø±Ø¹Ø© Ø£Ùˆ Ù‚Ø·Ø± Ø§Ù„Ø¨ÙƒØ±Ø©</h2>
                    <div class="calculator" id="pulley-calculator">
                        <div class="calculator-description">
                            Ø§Ø­Ø³Ø¨ Ø§Ù„Ø³Ø±Ø¹Ø© Ø£Ùˆ Ø§Ù„Ù‚Ø·Ø± Ø§Ù„Ù…Ø¬Ù‡ÙˆÙ„ Ù„Ù„Ø¨ÙƒØ±Ø© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø«Ù„Ø§Ø«Ø© Ù‚ÙŠÙ… Ù…Ø¹Ù„ÙˆÙ…Ø©.
                        </div>
                        <div class="input-group">
                            <label for="pulley-d1">Ù‚Ø·Ø± Ø§Ù„Ø¨ÙƒØ±Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ (Ù…Ù…)</label>
                            <input type="number" id="pulley-d1" placeholder="Ù‚Ø·Ø± Ø§Ù„Ø¨ÙƒØ±Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ (Ø§ØªØ±ÙƒÙ‡ ÙØ§Ø±ØºØ§Ù‹ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…Ø¬Ù‡ÙˆÙ„Ø§Ù‹)"
                                min="0">
                        </div>
                        <div class="input-group">
                            <label for="pulley-rpm1">Ø³Ø±Ø¹Ø© Ø§Ù„Ø¨ÙƒØ±Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ (RPM)</label>
                            <input type="number" id="pulley-rpm1" placeholder="Ø³Ø±Ø¹Ø© Ø§Ù„Ø¨ÙƒØ±Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ (Ø§ØªØ±ÙƒÙ‡ ÙØ§Ø±ØºØ§Ù‹ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…Ø¬Ù‡ÙˆÙ„Ø§Ù‹)"
                                min="0">
                        </div>
                        <div class="input-group">
                            <label for="pulley-d2">Ù‚Ø·Ø± Ø§Ù„Ø¨ÙƒØ±Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ© (Ù…Ù…)</label>
                            <input type="number" id="pulley-d2" placeholder="Ù‚Ø·Ø± Ø§Ù„Ø¨ÙƒØ±Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ© (Ø§ØªØ±ÙƒÙ‡ ÙØ§Ø±ØºØ§Ù‹ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…Ø¬Ù‡ÙˆÙ„Ø§Ù‹)"
                                min="0">
                        </div>
                        <div class="input-group">
                            <label for="pulley-rpm2">Ø³Ø±Ø¹Ø© Ø§Ù„Ø¨ÙƒØ±Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ© (RPM)</label>
                            <input type="number" id="pulley-rpm2" placeholder="Ø³Ø±Ø¹Ø© Ø§Ù„Ø¨ÙƒØ±Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ© (Ø§ØªØ±ÙƒÙ‡ ÙØ§Ø±ØºØ§Ù‹ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…Ø¬Ù‡ÙˆÙ„Ø§Ù‹)"
                                min="0">
                        </div>
                        <button id="calculate-pulley-btn">Ø§Ø­Ø³Ø¨ Ø§Ù„Ù…Ø¬Ù‡ÙˆÙ„</button>
                        <div class="result" id="pulley-result">Ø§Ù„Ù†ØªØ§Ø¦Ø¬: ...</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="section">
            <h2 class="section-title" data-modal-target="modal-battery-calculator">
                <span class="icon">ğŸ”‹</span>
                <span class="text">Ø­Ø§Ø³Ø¨Ø© Ø³Ø¹Ø© Ø§Ù„Ø¨Ø·Ø§Ø±ÙŠØ©</span>
            </h2>
            <div id="modal-battery-calculator" class="modal">
                <div class="modal-content">
                    <span class="close-button">&times;</span>
                    <h2>ğŸ”‹ Ø­Ø§Ø³Ø¨Ø© Ø³Ø¹Ø© Ø§Ù„Ø¨Ø·Ø§Ø±ÙŠØ©</h2>
                    <div class="calculator" id="battery-calculator">
                        <div class="calculator-description">
                            Ø­Ø³Ø§Ø¨ Ø³Ø¹Ø© Ø§Ù„Ø¨Ø·Ø§Ø±ÙŠØ© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ø¨Ø§Ù„Ø£Ù…Ø¨ÙŠØ±-Ø³Ø§Ø¹Ø© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ø¬Ù‡Ø§Ø² ÙˆØ¬Ù‡Ø¯ Ø§Ù„Ø¨Ø·Ø§Ø±ÙŠØ©ØŒ Ù…Ø¹ Ù…Ø±Ø§Ø¹Ø§Ø©
                            Ø¹Ù…Ù‚ Ø§Ù„ØªÙØ±ÙŠØº ÙˆÙƒÙØ§Ø¡Ø© Ø§Ù„Ø¨Ø·Ø§Ø±ÙŠØ©ØŒ ÙˆÙ†ÙˆØ¹ Ø§Ù„Ø¬Ù‡Ø§Ø² (DC/AC)ØŒ ÙˆØ·ÙˆØ±Ù‡ ÙˆÙ…Ø¹Ø§Ù…Ù„ Ù‚Ø¯Ø±ØªÙ‡ ÙˆÙƒÙØ§Ø¡Ø© Ø§Ù„Ù…Ø­ÙˆÙ„ (Ù„Ø£Ø­Ù…Ø§Ù„
                            Ø§Ù„ØªÙŠØ§Ø± Ø§Ù„Ù…ØªØ±Ø¯Ø¯).
                        </div>
                        <div class="input-group">
                            <label for="battery-device-type">Ù†ÙˆØ¹ Ø§Ù„Ø¬Ù‡Ø§Ø²</label>
                            <select id="battery-device-type">
                                <option value="dc">ØªÙŠØ§Ø± Ù…Ø³ØªÙ…Ø± (DC)</option>
                                <option value="ac">ØªÙŠØ§Ø± Ù…ØªØ±Ø¯Ø¯ (AC)</option>
                            </select>
                        </div>
                        <div class="input-group">
                            <label for="device-voltage">Ø¬Ù‡Ø¯ Ø§Ù„Ø¬Ù‡Ø§Ø² (V)</label>
                            <input type="number" id="device-voltage" placeholder="ØªÙˆØªØ± Ø§Ù„Ø¬Ù‡Ø§Ø² Ø¨Ø§Ù„ÙÙˆÙ„Øª" min="1">
                        </div>
                        <div class="input-group">
                            <label for="device-current">ØªÙŠØ§Ø± Ø§Ù„Ø¬Ù‡Ø§Ø² (A)</label>
                            <input type="number" id="device-current" placeholder="ØªÙŠØ§Ø± Ø§Ù„Ø¬Ù‡Ø§Ø² Ø¨Ø§Ù„Ø£Ù…Ø¨ÙŠØ±" min="0.1">
                        </div>

                        <div class="input-group battery-ac-only" style="display: none;">
                            <label for="battery-device-phase">Ø·ÙˆØ± Ø§Ù„Ø¬Ù‡Ø§Ø²</label>
                            <select id="battery-device-phase">
                                <option value="single">Ø£Ø­Ø§Ø¯ÙŠ Ø§Ù„Ø·ÙˆØ±</option>
                                <option value="three">Ø«Ù„Ø§Ø«ÙŠ Ø§Ù„Ø·ÙˆØ±</option>
                            </select>
                        </div>
                        <div class="input-group battery-ac-only" style="display: none;">
                            <label for="battery-device-power-factor">Ù…Ø¹Ø§Ù…Ù„ Ù‚Ø¯Ø±Ø© Ø§Ù„Ø¬Ù‡Ø§Ø² (cos Ï†)</label>
                            <input type="number" id="battery-device-power-factor" value="0.8" step="0.01" min="0.1"
                                max="1" placeholder="Ù…Ø«Ø§Ù„: 0.8">
                        </div>
                        <div class="input-group battery-ac-only" style="display: none;">
                            <label for="inverter-efficiency-battery">ÙƒÙØ§Ø¡Ø© Ø§Ù„Ù…Ø­ÙˆÙ„ (Inverter Efficiency %)</label>
                            <input type="number" id="inverter-efficiency-battery" value="90" min="50" max="100" step="1"
                                placeholder="Ù…Ø«Ø§Ù„: 90 (90%)">
                        </div>

                        <div class="input-group">
                            <label for="operation-duration">Ù…Ø¯Ø© Ø§Ù„ØªØ´ØºÙŠÙ„ (Ø¨Ø§Ù„Ø³Ø§Ø¹Ø§Øª)</label>
                            <input type="number" id="operation-duration" placeholder="Ù…Ø¯Ø© Ø§Ù„ØªØ´ØºÙŠÙ„ Ø¨Ø§Ù„Ø³Ø§Ø¹Ø§Øª" min="0.1">
                        </div>
                        <div class="input-group">
                            <label for="battery-voltage">ØªÙˆØªØ± Ø§Ù„Ø¨Ø·Ø§Ø±ÙŠØ© (V)</label>
                            <input type="number" id="battery-voltage" placeholder="ØªÙˆØªØ± Ø§Ù„Ø¨Ø·Ø§Ø±ÙŠØ© Ø¨Ø§Ù„ÙÙˆÙ„Øª" min="1">
                        </div>
                        <div class="input-group">
                            <label for="battery-dod">Ø¹Ù…Ù‚ Ø§Ù„ØªÙØ±ÙŠØº Ø§Ù„Ø£Ù‚ØµÙ‰ (%)</label>
                            <input type="number" id="battery-dod" value="80" min="10" max="100" step="1"
                                placeholder="Ù…Ø«Ø§Ù„: 80 (80%)">
                        </div>
                        <div class="input-group">
                            <label for="battery-efficiency">ÙƒÙØ§Ø¡Ø© Ø§Ù„Ø¨Ø·Ø§Ø±ÙŠØ© (%)</label>
                            <input type="number" id="battery-efficiency" value="90" min="50" max="100" step="1"
                                placeholder="Ù…Ø«Ø§Ù„: 90 (90%)">
                        </div>
                        <button id="calculate-battery-btn">Ø§Ø­Ø³Ø¨ Ø§Ù„Ø³Ø¹Ø©</button>
                        <div class="result" id="battery-result">Ø§Ù„Ù†ØªØ§Ø¦Ø¬: ...</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="section">
            <h2 class="section-title" data-modal-target="modal-flow-converter">
                <span class="icon">ğŸ’§</span>
                <span class="text">ØªØ­ÙˆÙŠÙ„ ÙˆØ­Ø¯Ø§Øª Ø§Ù„ØªØ¯ÙÙ‚</span>
            </h2>
            <div id="modal-flow-converter" class="modal">
                <div class="modal-content">
                    <span class="close-button">&times;</span>
                    <h2>ğŸ’§ ØªØ­ÙˆÙŠÙ„ ÙˆØ­Ø¯Ø§Øª Ø§Ù„ØªØ¯ÙÙ‚</h2>
                    <div class="calculator" id="flow-converter">
                        <div class="calculator-description">
                            ØªØ­ÙˆÙŠÙ„ Ù…Ø¹Ø¯Ù„ Ø§Ù„ØªØ¯ÙÙ‚ Ø¨ÙŠÙ† Ù…ØªØ± Ù…ÙƒØ¹Ø¨ ÙÙŠ Ø§Ù„Ø³Ø§Ø¹Ø© ÙˆÙ„ØªØ± ÙÙŠ Ø§Ù„Ø«Ø§Ù†ÙŠØ©.
                        </div>
                        <div class="input-group">
                            <label for="flow-input-value">Ø§Ù„Ù‚ÙŠÙ…Ø©</label>
                            <input type="number" id="flow-input-value" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ù‚ÙŠÙ…Ø© Ù„Ù„ØªØ­ÙˆÙŠÙ„" min="0">
                        </div>
                        <div class="input-group">
                            <label for="flow-conversion-type">Ù†ÙˆØ¹ Ø§Ù„ØªØ­ÙˆÙŠÙ„</label>
                            <select id="flow-conversion-type">
                                <option value="m3h-to-lps">Ù…Ù† Ù…Â³/Ø³Ø§Ø¹Ø© Ø¥Ù„Ù‰ Ù„ØªØ±/Ø«Ø§Ù†ÙŠØ©</option>
                                <option value="lps-to-m3h">Ù…Ù† Ù„ØªØ±/Ø«Ø§Ù†ÙŠØ© Ø¥Ù„Ù‰ Ù…Â³/Ø³Ø§Ø¹Ø©</option>
                            </select>
                        </div>
                        <button id="convert-flow-btn">ØªØ­ÙˆÙŠÙ„</button>
                        <div class="result" id="flow-result">Ø§Ù„Ù†ØªÙŠØ¬Ø©: ...</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="section">
            <h2 class="section-title" data-modal-target="modal-tank-calculator">
                <span class="icon">ğŸ§±</span>
                <span class="text">Ø­Ø³Ø§Ø¨ Ø³Ø¹Ø© Ø§Ù„Ø®Ø²Ø§Ù† ÙˆØ§Ù„ØªØ¯ÙÙ‚</span>
            </h2>
            <div id="modal-tank-calculator" class="modal">
                <div class="modal-content">
                    <span class="close-button">&times;</span>
                    <h2>ğŸ§± Ø­Ø³Ø§Ø¨ Ø³Ø¹Ø© Ø§Ù„Ø®Ø²Ø§Ù† ÙˆØ§Ù„ØªØ¯ÙÙ‚</h2>
                    <div class="calculator" id="tank-calculator">
                        <div class="calculator-description">
                            Ø­Ø³Ø§Ø¨ Ø³Ø¹Ø© Ø§Ù„Ø®Ø²Ø§Ù† ÙˆÙ…Ø¯Ø© ØªÙØ±ÙŠØºÙ‡ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ ÙˆØ´ÙƒÙ„ Ø§Ù„Ø®Ø²Ø§Ù† ÙˆÙ…Ø¹Ø¯Ù„ Ø§Ù„ØªØ¯ÙÙ‚.
                        </div>
                        <div class="input-group">
                            <label for="tank-shape">Ø´ÙƒÙ„ Ø§Ù„Ø®Ø²Ø§Ù†</label>
                            <select id="tank-shape">
                                <option value="cube">Ù…ÙƒØ¹Ø¨</option>
                                <option value="cylinder">Ø£Ø³Ø·ÙˆØ§Ù†ÙŠ</option>
                            </select>
                        </div>
                        <div class="input-group">
                            <label for="tank-length">Ø§Ù„Ø·ÙˆÙ„ (Ù…ØªØ±) / Ø§Ù„Ù‚Ø·Ø± (Ù…ØªØ±)</label>
                            <input type="number" id="tank-length" placeholder="Ù„Ù„Ù…ÙƒØ¹Ø¨: Ø§Ù„Ø·ÙˆÙ„ / Ù„Ù„Ø£Ø³Ø·ÙˆØ§Ù†ÙŠ: Ø§Ù„Ù‚Ø·Ø±"
                                min="0.1">
                        </div>
                        <div class="input-group" id="tank-width-group">
                            <label for="tank-width">Ø§Ù„Ø¹Ø±Ø¶ (Ù…ØªØ±)</label>
                            <input type="number" id="tank-width" placeholder="Ø§Ù„Ø¹Ø±Ø¶ Ø¨Ø§Ù„Ù…ØªØ±" min="0.1">
                        </div>
                        <div class="input-group">
                            <label for="tank-height">Ø§Ù„Ø§Ø±ØªÙØ§Ø¹ (Ù…ØªØ±)</label>
                            <input type="number" id="tank-height" placeholder="Ø§Ù„Ø§Ø±ØªÙØ§Ø¹ Ø¨Ø§Ù„Ù…ØªØ±" min="0.1">
                        </div>
                        <div class="input-group">
                            <label for="tank-flow-rate">ØªØ¯ÙÙ‚ Ø§Ù„Ù…ÙŠØ§Ù‡ (Ù…Â³/Ø³Ø§Ø¹Ø©)</label>
                            <input type="number" id="tank-flow-rate" placeholder="Ù…Ø¹Ø¯Ù„ ØªØ¯ÙÙ‚ Ø§Ù„Ù…ÙŠØ§Ù‡ Ù„ØªÙØ±ÙŠØº Ø§Ù„Ø®Ø²Ø§Ù†"
                                min="0.1">
                        </div>
                        <button id="calculate-tank-btn">Ø§Ø­Ø³Ø¨ Ø§Ù„Ø³Ø¹Ø© ÙˆØ§Ù„ÙˆÙ‚Øª</button>
                        <div class="result" id="tank-result">Ø§Ù„Ù†ØªØ§Ø¦Ø¬: ...</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="section">
            <h2 class="section-title" data-modal-target="modal-resistance-voltage-drop">
                <span class="icon">ğŸ“</span>
                <span class="text">Ø­Ø§Ø³Ø¨Ø© Ù…Ø³Ø§Ø­Ø© Ù…Ù‚Ø·Ø¹ Ø§Ù„Ù…ÙˆØµÙ„ (ÙÙ‚Ø¯ Ø§Ù„Ø¬Ù‡Ø¯)</span>
            </h2>
            <div id="modal-resistance-voltage-drop" class="modal">
                <div class="modal-content">
                    <span class="close-button">&times;</span>
                    <h2>ğŸ“ Ø­Ø§Ø³Ø¨Ø© Ù…Ø³Ø§Ø­Ø© Ù…Ù‚Ø·Ø¹ Ø§Ù„Ù…ÙˆØµÙ„ (ÙÙ‚Ø¯ Ø§Ù„Ø¬Ù‡Ø¯)</h2>
                    <div class="calculator" id="resistance-voltage-drop">
                        <div class="calculator-description">
                            Ø§Ø­Ø³Ø¨ Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ù…Ù‚Ø·Ø¹ Ø§Ù„Ø¹Ø±Ø¶ÙŠ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù„Ù…ÙˆØµÙ„ Ù„Ø¶Ù…Ø§Ù† Ø£Ù† ÙÙ‚Ø¯ Ø§Ù„Ø¬Ù‡Ø¯ Ù„Ø§ ÙŠØªØ¬Ø§ÙˆØ² Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø³Ù…ÙˆØ­ Ø¨Ù‡Ø§ØŒ Ù…Ø¹
                            Ù…Ø±Ø§Ø¹Ø§Ø© Ù†ÙˆØ¹ Ø§Ù„Ø·ÙˆØ± ÙˆÙ…Ø¹Ø§Ù…Ù„ Ø§Ù„Ù‚Ø¯Ø±Ø©.
                        </div>
                        <div class="input-group">
                            <label for="rvd-voltage">Ø§Ù„Ø¬Ù‡Ø¯ Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠ (V)</label>
                            <input type="number" id="rvd-voltage" placeholder="Ø§Ù„Ø¬Ù‡Ø¯ Ø¨Ø§Ù„ÙÙˆÙ„Øª" min="1">
                        </div>
                        <div class="input-group">
                            <label for="rvd-current">Ø§Ù„ØªÙŠØ§Ø± Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠ (A)</label>
                            <input type="number" id="rvd-current" placeholder="Ø§Ù„ØªÙŠØ§Ø± Ø¨Ø§Ù„Ø£Ù…Ø¨ÙŠØ±" min="0.1">
                        </div>
                        <div class="input-group">
                            <label for="rvd-phase">Ù†ÙˆØ¹ Ø§Ù„Ø·ÙˆØ±</label>
                            <select id="rvd-phase">
                                <option value="single">Ø£Ø­Ø§Ø¯ÙŠ Ø§Ù„Ø·ÙˆØ±</option>
                                <option value="three">Ø«Ù„Ø§Ø«ÙŠ Ø§Ù„Ø·ÙˆØ±</option>
                            </select>
                        </div>
                        <div class="input-group">
                            <label for="rvd-power-factor">Ù…Ø¹Ø§Ù…Ù„ Ø§Ù„Ù‚Ø¯Ø±Ø© (cos Ï†)</label>
                            <input type="number" id="rvd-power-factor" value="0.8" step="0.01" min="0.1" max="1"
                                placeholder="Ù…Ø«Ø§Ù„: 0.8">
                        </div>
                        <div class="input-group">
                            <label for="rvd-material">Ù†ÙˆØ¹ Ø§Ù„Ù…Ø§Ø¯Ø©</label>
                            <select id="rvd-material">
                                <option value="copper">Ù†Ø­Ø§Ø³ (0.0172 Î©Â·mmÂ²/m)</option>
                                <option value="aluminum">Ø£Ù„Ù…Ù†ÙŠÙˆÙ… (0.0282 Î©Â·mmÂ²/m)</option>
                            </select>
                        </div>
                        <div class="input-group">
                            <label for="rvd-length">Ø·ÙˆÙ„ Ø§Ù„Ù…ÙˆØµÙ„ (Ù…ØªØ±) - (Ø·ÙˆÙ„ ÙÙŠ Ø§ØªØ¬Ø§Ù‡ ÙˆØ§Ø­Ø¯)</label>
                            <input type="number" id="rvd-length" placeholder="Ø·ÙˆÙ„ Ø§Ù„ÙƒØ§Ø¨Ù„ Ø¨Ø§Ù„Ù…ØªØ±" min="0.1">
                        </div>
                        <div class="input-group">
                            <label for="rvd-allowed-voltage-drop-percentage">Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù„ÙÙ‚Ø¯ Ø§Ù„Ø¬Ù‡Ø¯ Ø§Ù„Ù…Ø³Ù…ÙˆØ­ Ø¨Ù‡ (%)</label>
                            <input type="number" id="rvd-allowed-voltage-drop-percentage" value="3" min="0.1" max="10"
                                step="0.1" placeholder="Ù…Ø«Ø§Ù„: 3 (3%)">
                        </div>
                        <button id="calculate-rvd-btn">Ø§Ø­Ø³Ø¨ Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ù…Ù‚Ø·Ø¹</button>
                        <div class="result" id="rvd-result">Ø§Ù„Ù†ØªØ§Ø¦Ø¬: ...</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="section">
            <h2 class="section-title" data-modal-target="modal-capacitor-calculator">
                <span class="icon">âš¡</span>
                <span class="text">Ø­Ø³Ø§Ø¨ Ø³Ø¹Ø© Ø§Ù„Ù…ÙƒØ«Ù Ù„ØªØ­Ø³ÙŠÙ† Ù…Ø¹Ø§Ù…Ù„ Ø§Ù„Ù‚Ø¯Ø±Ø©</span>
            </h2>
            <div id="modal-capacitor-calculator" class="modal">
                <div class="modal-content">
                    <span class="close-button">&times;</span>
                    <h2>âš¡ Ø­Ø³Ø§Ø¨ Ø³Ø¹Ø© Ø§Ù„Ù…ÙƒØ«Ù Ù„ØªØ­Ø³ÙŠÙ† Ù…Ø¹Ø§Ù…Ù„ Ø§Ù„Ù‚Ø¯Ø±Ø©</h2>
                    <div class="calculator" id="capacitor-calculator">
                        <div class="calculator-description">
                            Ø­Ø³Ø§Ø¨ Ø³Ø¹Ø© Ø§Ù„Ù…ÙƒØ«Ù Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© (ÂµF) Ù„ØªØ­Ø³ÙŠÙ† Ù…Ø¹Ø§Ù…Ù„ Ø§Ù„Ù‚Ø¯Ø±Ø© ÙÙŠ Ø§Ù„Ø¯ÙˆØ§Ø¦Ø± Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ©ØŒ Ù…Ø¹ Ø¥Ù…ÙƒØ§Ù†ÙŠØ© ØªØ­Ø¯ÙŠØ¯
                            Ø§Ù„ØªØ±Ø¯Ø¯ ÙˆÙ†ÙˆØ¹ Ø§Ù„Ø·ÙˆØ±.
                        </div>
                        <div class="input-group">
                            <label for="cap-voltage">Ø¬Ù‡Ø¯ Ø§Ù„ØªØ´ØºÙŠÙ„ (V)</label>
                            <input type="number" id="cap-voltage" placeholder="Ø¬Ù‡Ø¯ Ø§Ù„ØªØ´ØºÙŠÙ„ Ø¨Ø§Ù„ÙÙˆÙ„Øª" min="1">
                        </div>
                        <div class="input-group">
                            <label for="cap-phase">Ù†ÙˆØ¹ Ø§Ù„Ø·ÙˆØ±</label>
                            <select id="cap-phase">
                                <option value="single">Ø£Ø­Ø§Ø¯ÙŠ Ø§Ù„Ø·ÙˆØ±</option>
                                <option value="three">Ø«Ù„Ø§Ø«ÙŠ Ø§Ù„Ø·ÙˆØ±</option>
                            </select>
                        </div>
                        <div class="input-group">
                            <label for="cap-real-power">Ø§Ù„Ù‚Ø¯Ø±Ø© Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ© (kW)</label>
                            <input type="number" id="cap-real-power" placeholder="Ø§Ù„Ù‚Ø¯Ø±Ø© Ø¨Ø§Ù„ÙƒÙŠÙ„ÙˆÙˆØ§Ø·" min="0.1">
                        </div>
                        <div class="input-group">
                            <label for="cap-current-pf">Ù…Ø¹Ø§Ù…Ù„ Ø§Ù„Ù‚Ø¯Ø±Ø© Ø§Ù„Ø­Ø§Ù„ÙŠ (cos Ï†)</label>
                            <input type="number" id="cap-current-pf" placeholder="Ù…Ø«Ø§Ù„: 0.7" min="0.1" max="0.99"
                                step="0.01">
                        </div>
                        <div class="input-group">
                            <label for="cap-desired-pf">Ù…Ø¹Ø§Ù…Ù„ Ø§Ù„Ù‚Ø¯Ø±Ø© Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù (cos Ï†^)</label>
                            <input type="number" id="cap-desired-pf" placeholder="Ù…Ø«Ø§Ù„: 0.95" min="0.1" max="0.99"
                                step="0.01">
                        </div>
                        <div class="input-group">
                            <label for="cap-frequency">Ø§Ù„ØªØ±Ø¯Ø¯ (Hz)</label>
                            <input type="number" id="cap-frequency" value="50" min="1" step="1"
                                placeholder="Ù…Ø«Ø§Ù„: 50 Ø£Ùˆ 60">
                        </div>
                        <button id="calculate-capacitor-btn">Ø§Ø­Ø³Ø¨ Ø§Ù„Ø³Ø¹Ø©</button>
                        <div class="result" id="capacitor-result">Ø§Ù„Ø³Ø¹Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©: ...</div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const sectionTitles = document.querySelectorAll(".section-title");
            const modals = document.querySelectorAll(".modal");
            const closeButtons = document.querySelectorAll(".close-button");

            function displayResult(elementId, message, isSuccess) {
                const resultElement = document.getElementById(elementId);
                if (!resultElement) {
                    console.error(`Result element with ID '${elementId}' not found.`);
                    return;
                }
                resultElement.innerHTML = message;
                resultElement.className = `result ${isSuccess ? 'success' : 'error'}`;
            }

            function saveCalculatorState(calculatorId, data) {
                try {
                    localStorage.setItem(calculatorId + '_state', JSON.stringify(data));
                    // console.log(`State of ${calculatorId} saved:`, data); // For debugging
                } catch (e) {
                    console.error("Error saving data to localStorage:", e);
                }
            }

            function loadCalculatorState(calculatorId) {
                try {
                    const storedData = localStorage.getItem(calculatorId + '_state');
                    if (storedData) {
                        // console.log(`State of ${calculatorId} loaded:`, JSON.parse(storedData)); // For debugging
                        return JSON.parse(storedData);
                    }
                } catch (e) {
                    console.error("Error loading data from Local Storage:", e);
                }
                return null;
            }
            
            function populateInputs(calculatorId, inputsData, targetElement) {
                // console.log(`Populating inputs for ${calculatorId}`); // For debugging
                // console.log('Inputs data:', inputsData); // For debugging
                if (!targetElement || !inputsData) return;

                const currentDefaultValues = {
                    'unit-converter': {
                        'uc-power-factor': "0.8",
                        'uc-input-unit': "kw",
                        'uc-phase': "single"
                    },
                    'tank-calculator': {
                        'tank-shape': "cube"
                    },
                    'resistance-voltage-drop': {
                        'rvd-material': "copper",
                        'rvd-allowed-voltage-drop-percentage': "3",
                        'rvd-phase': "single",
                        'rvd-power-factor': "0.8"
                    },
                    'flow-converter': {
                        'flow-conversion-type': "m3h-to-lps"
                    },
                    'capacitor-calculator': {
                        'cap-current-pf': "0.7",
                        'cap-desired-pf': "0.95",
                        'cap-frequency': "50",
                        'cap-phase': "single"
                    },
                    'solar-panels-calculator': {
                        'solar-performance-factor': "80",
                        'inverter-efficiency': "90",
                        'pump-voltage': "230",
                        'pump-phase': "single",
                        'pump-power-factor': "0.8",
                        'ideal-series-voltage': ""
                    },
                    'battery-calculator': {
                        'battery-dod': "80",
                        'battery-efficiency': "90",
                        'battery-device-type': "dc",
                        'battery-device-phase': "single",
                        'battery-device-power-factor': "0.8",
                        'inverter-efficiency-battery': "90"
                    },
                    'pulley-calculator': {
                        'pulley-d1': "",
                        'pulley-rpm1': "",
                        'pulley-d2': "",
                        'pulley-rpm2': ""
                    }
                };

                // First, apply default values if they exist for the current calculator
                if (currentDefaultValues[calculatorId]) {
                    for (const defaultKey in currentDefaultValues[calculatorId]) {
                        const defaultInputElement = targetElement.querySelector(`#${defaultKey}`);
                        if (defaultInputElement) {
                            defaultInputElement.value = currentDefaultValues[calculatorId][defaultKey];
                        }
                    }
                }

                // Then, populate fields with saved data, overriding defaults if saved data exists
                for (const key in inputsData) {
                    let inputElementId = key.replace(/([A-Z])/g, '-$1').toLowerCase();

                    // Special handling for some IDs that don't follow direct conversion pattern
                    if (calculatorId === 'unit-converter') {
                        if (key === 'voltage') inputElementId = 'uc-voltage';
                        else if (key === 'inputValue') inputElementId = 'uc-input-value';
                        else if (key === 'inputUnit') inputElementId = 'uc-input-unit';
                        else if (key === 'powerFactor') inputElementId = 'uc-power-factor';
                        else if (key === 'phase') inputElementId = 'uc-phase';
                    } else if (calculatorId === 'solar-panels-calculator') {
                        if (key === 'pumpPowerKw') inputElementId = 'pump-power-kw';
                        else if (key === 'pumpVoltage') inputElementId = 'pump-voltage';
                        else if (key === 'pumpPhase') inputElementId = 'pump-phase';
                        else if (key === 'pumpPowerFactor') inputElementId = 'pump-power-factor';
                        else if (key === 'panelVoltage') inputElementId = 'panel-voltage';
                        else if (key === 'panelCurrent') inputElementId = 'panel-current';
                        else if (key === 'solarPerformanceFactor') inputElementId = 'solar-performance-factor';
                        else if (key === 'inverterEfficiency') inputElementId = 'inverter-efficiency';
                        else if (key === 'idealSeriesVoltage') inputElementId = 'ideal-series-voltage';
                    } else if (calculatorId === 'battery-calculator') {
                        if (key === 'deviceType') inputElementId = 'battery-device-type';
                        else if (key === 'devicePhase') inputElementId = 'battery-device-phase';
                        else if (key === 'devicePowerFactor') inputElementId = 'battery-device-power-factor';
                        else if (key === 'inverterEfficiencyBattery') inputElementId = 'inverter-efficiency-battery';
                        else if (key === 'deviceVoltage') inputElementId = 'device-voltage';
                        else if (key === 'deviceCurrent') inputElementId = 'device-current';
                        else if (key === 'operationDuration') inputElementId = 'operation-duration';
                        else if (key === 'batteryVoltage') inputElementId = 'battery-voltage';
                        else if (key === 'dod') inputElementId = 'battery-dod';
                        else if (key === 'efficiency') inputElementId = 'battery-efficiency';
                    } else if (calculatorId === 'percentage-calculator') {
                        if (key === 'originalNumber') inputElementId = 'original-number';
                        else if (key === 'percentageValue') inputElementId = 'percentage-value';
                    } else if (calculatorId === 'capacitor-calculator') {
                        if (key === 'voltage') inputElementId = 'cap-voltage';
                        else if (key === 'realPowerKW') inputElementId = 'cap-real-power';
                        else if (key === 'currentPF') inputElementId = 'cap-current-pf';
                        else if (key === 'desiredPF') inputElementId = 'cap-desired-pf';
                        else if (key === 'frequency') inputElementId = 'cap-frequency';
                        else if (key === 'phase') inputElementId = 'cap-phase';
                    } else if (calculatorId === 'flow-converter') {
                        if (key === 'inputValue') inputElementId = 'flow-input-value';
                        else if (key === 'conversionType') inputElementId = 'flow-conversion-type';
                    } else if (calculatorId === 'tank-calculator') {
                        if (key === 'tankShape') inputElementId = 'tank-shape';
                        else if (key === 'lengthOrDiameter') inputElementId = 'tank-length';
                        else if (key === 'width') inputElementId = 'tank-width';
                        else if (key === 'height') inputElementId = 'tank-height';
                        else if (key === 'flowRateM3H') inputElementId = 'tank-flow-rate';
                    } else if (calculatorId === 'resistance-voltage-drop') {
                        if (key === 'voltage') inputElementId = 'rvd-voltage';
                        else if (key === 'current') inputElementId = 'rvd-current';
                        else if (key === 'material') inputElementId = 'rvd-material';
                        else if (key === 'length') inputElementId = 'rvd-length';
                        else if (key === 'allowedVoltageDropPercentage') inputElementId = 'rvd-allowed-voltage-drop-percentage';
                        else if (key === 'phase') inputElementId = 'rvd-phase';
                        else if (key === 'powerFactor') inputElementId = 'rvd-power-factor';
                    } else if (calculatorId === 'pulley-calculator') {
                        if (key === 'd1') inputElementId = 'pulley-d1';
                        else if (key === 'rpm1') inputElementId = 'pulley-rpm1';
                        else if (key === 'd2') inputElementId = 'pulley-d2';
                        else if (key === 'rpm2') inputElementId = 'pulley-rpm2';
                    }

                    const inputElement = targetElement.querySelector(`#${inputElementId}`);
                    // console.log(`Attempting to set ${inputElementId} to ${inputsData[key]}`); // For debugging
                    if (inputElement && (inputElement.type === 'number' || inputElement.type === 'text' || inputElement.tagName === 'SELECT') && inputsData[key] !== null && inputsData[key] !== undefined) {
                        inputElement.value = inputsData[key];
                    }
                }

                // Manually dispatch change events for select fields that affect other field visibility
                if (calculatorId === 'tank-calculator') {
                    const tankShapeSelect = targetElement.querySelector('#tank-shape');
                    if (tankShapeSelect) {
                        const event = new Event('change');
                        tankShapeSelect.dispatchEvent(event);
                    }
                }
                if (calculatorId === 'battery-calculator') {
                    const deviceTypeSelect = targetElement.querySelector('#battery-device-type');
                    if (deviceTypeSelect) {
                        const event = new Event('change');
                        deviceTypeSelect.dispatchEvent(event);
                    }
                }
            }

            const calculatorFunctions = {
                "unit-converter": {
                    calculate: function () {
                        const voltage = parseFloat(document.getElementById("uc-voltage").value);
                        const phase = document.getElementById("uc-phase").value;
                        const powerFactor = parseFloat(document.getElementById("uc-power-factor").value);
                        const inputValue = parseFloat(document.getElementById("uc-input-value").value);
                        const inputUnit = document.getElementById("uc-input-unit").value;

                        if (isNaN(voltage) || voltage <= 0) { displayResult("uc-result", "Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø¬Ù‡Ø¯ ØµØ­ÙŠØ­ ÙˆÙ…ÙˆØ¬Ø¨.", false); return; }
                        if (isNaN(powerFactor) || powerFactor <= 0.1 || powerFactor > 1) { displayResult("uc-result", "Ù…Ø¹Ø§Ù…Ù„ Ø§Ù„Ù‚Ø¯Ø±Ø© ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø¨ÙŠÙ† 0.1 Ùˆ 1.", false); return; }
                        if (isNaN(inputValue) || inputValue < 0) { displayResult("uc-result", "Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ù‚ÙŠÙ…Ø© ØµØ­ÙŠØ­Ø© ÙˆÙ…ÙˆØ¬Ø¨Ø© Ù„Ù„ØªØ­ÙˆÙŠÙ„.", false); return; }

                        const sqrt3 = Math.sqrt(3);
                        const HP_TO_KW_FACTOR = 0.7457;

                        let kw = 0, kva = 0, hp = 0, amp = 0;
                        let basePowerWatts = 0;
                        let baseApparentPowerVA = 0;

                        switch (inputUnit) {
                            case 'kw':
                                basePowerWatts = inputValue * 1000;
                                baseApparentPowerVA = basePowerWatts / powerFactor;
                                break;
                            case 'kva':
                                baseApparentPowerVA = inputValue * 1000;
                                basePowerWatts = baseApparentPowerVA * powerFactor;
                                break;
                            case 'hp':
                                basePowerWatts = inputValue * HP_TO_KW_FACTOR * 1000;
                                baseApparentPowerVA = basePowerWatts / powerFactor;
                                break;
                            case 'amp':
                                if (phase === "single") {
                                    baseApparentPowerVA = voltage * inputValue;
                                } else {
                                    baseApparentPowerVA = sqrt3 * voltage * inputValue;
                                }
                                basePowerWatts = baseApparentPowerVA * powerFactor;
                                break;
                        }

                        kw = basePowerWatts / 1000;
                        kva = baseApparentPowerVA / 1000;
                        hp = kw / HP_TO_KW_FACTOR;

                        if (voltage === 0) {
                            displayResult("uc-result", "Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¬Ù‡Ø¯ Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠ. Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø£Ù† ÙŠÙƒÙˆÙ† ØµÙØ±Ù‹Ø§.", false); return;
                        }
                        if (phase === "single") {
                            amp = baseApparentPowerVA / voltage;
                        } else {
                            if (sqrt3 * voltage === 0) {
                                displayResult("uc-result", "Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¬Ù‡Ø¯ Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠ Ù„Ù„Ø·ÙˆØ± Ø§Ù„Ø«Ù„Ø§Ø«ÙŠ. Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø£Ù† ÙŠÙƒÙˆÙ† ØµÙØ±Ù‹Ø§.", false); return;
                            }
                            amp = baseApparentPowerVA / (sqrt3 * voltage);
                        }

                        const resultMessage = `
                            <p><strong>Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø£ØµÙ„ÙŠØ©:</strong> ${inputValue.toFixed(2)} ${inputUnit.toUpperCase()}</p>
                            <p><strong>Ø§Ù„Ø¬Ù‡Ø¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:</strong> ${voltage.toFixed(0)} V, <strong>Ø§Ù„Ø·ÙˆØ±:</strong> ${phase === "single" ? "Ø£Ø­Ø§Ø¯ÙŠ" : "Ø«Ù„Ø§Ø«ÙŠ"}, <strong>Ù…Ø¹Ø§Ù…Ù„ Ø§Ù„Ù‚Ø¯Ø±Ø©:</strong> ${powerFactor.toFixed(2)}</p>
                            <h3>Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ù…Ø­ÙˆÙ‘Ù„Ø©:</h3>
                            <ul>
                                <li>Ø§Ù„Ù‚Ø¯Ø±Ø© Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ© (Real Power): <strong>${kw.toFixed(2)} kW</strong></li>
                                <li>Ø§Ù„Ù‚Ø¯Ø±Ø© Ø§Ù„Ø¸Ø§Ù‡Ø±ÙŠØ© (Apparent Power): <strong>${kva.toFixed(2)} kVA</strong></li>
                                <li>Ø§Ù„Ù‚Ø¯Ø±Ø© Ø¨Ø§Ù„Ø­ØµØ§Ù† (Horsepower): <strong>${hp.toFixed(2)} HP</strong></li>
                                <li>Ø§Ù„ØªÙŠØ§Ø± Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠ (Current): <strong>${amp.toFixed(2)} A</strong></li>
                            </ul>
                            <p><small>Ù…Ù„Ø§Ø­Ø¸Ø©: ØªÙØ­Ø³Ø¨ Ø§Ù„Ù‚Ø¯Ø±Ø© Ø¨Ø§Ù„Ø­ØµØ§Ù† Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ 1 Ø­ØµØ§Ù† = 0.7457 ÙƒÙŠÙ„ÙˆÙˆØ§Ø·.</small></p>
                        `;
                        displayResult("uc-result", resultMessage, true);

                        const dataToSave = {
                            inputs: {
                                voltage: voltage,
                                phase: phase,
                                powerFactor: powerFactor,
                                inputValue: inputValue,
                                inputUnit: inputUnit
                            }
                        };
                        saveCalculatorState("unit-converter", dataToSave);
                    },
                },

                "solar-panels-calculator": {
                    calculate: function () {
                        const pumpPowerKw = parseFloat(document.getElementById("pump-power-kw").value);
                        const pumpVoltage = parseFloat(document.getElementById("pump-voltage").value);
                        const pumpPhase = document.getElementById("pump-phase").value;
                        const pumpPowerFactor = parseFloat(document.getElementById("pump-power-factor").value);
                        
                        const idealSeriesVoltage = parseFloat(document.getElementById("ideal-series-voltage").value);
                        const panelVoltage = parseFloat(document.getElementById("panel-voltage").value);
                        const panelCurrent = parseFloat(document.getElementById("panel-current").value);
                        const solarPerformanceFactor = parseFloat(document.getElementById("solar-performance-factor").value) / 100;
                        const inverterEfficiency = parseFloat(document.getElementById("inverter-efficiency").value) / 100;

                        if (isNaN(pumpPowerKw) || pumpPowerKw <= 0) { displayResult("solar-panels-result", "Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ù‚Ø¯Ø±Ø© Ù…Ø¶Ø®Ø© ØµØ­ÙŠØ­Ø© ÙˆÙ…ÙˆØ¬Ø¨Ø© Ø¨Ø§Ù„ÙƒÙŠÙ„ÙˆÙˆØ§Ø·.", false); return; }
                        if (isNaN(pumpVoltage) || pumpVoltage <= 0) { displayResult("solar-panels-result", "Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø¬Ù‡Ø¯ Ù…Ø¶Ø®Ø© ØµØ­ÙŠØ­ ÙˆÙ…ÙˆØ¬Ø¨.", false); return; }
                        if (isNaN(pumpPowerFactor) || pumpPowerFactor <= 0.1 || pumpPowerFactor > 1) { displayResult("solar-panels-result", "Ù…Ø¹Ø§Ù…Ù„ Ù‚Ø¯Ø±Ø© Ø§Ù„Ù…Ø¶Ø®Ø© ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø¨ÙŠÙ† 0.1 Ùˆ 1.", false); return; }

                        if (isNaN(panelVoltage) || panelVoltage <= 0) { displayResult("solar-panels-result", "Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø¬Ù‡Ø¯ Ù„ÙˆØ­ Ø´Ù…Ø³ÙŠ ØµØ­ÙŠØ­ ÙˆÙ…ÙˆØ¬Ø¨.", false); return; }
                        if (isNaN(panelCurrent) || panelCurrent <= 0) { displayResult("solar-panels-result", "Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ ØªÙŠØ§Ø± Ù„ÙˆØ­ Ø´Ù…Ø³ÙŠ ØµØ­ÙŠØ­ ÙˆÙ…ÙˆØ¬Ø¨.", false); return; }
                        if (isNaN(solarPerformanceFactor) || solarPerformanceFactor <= 0 || solarPerformanceFactor > 1) { displayResult("solar-panels-result", "Ø¹Ø§Ù…Ù„ Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø£Ù„ÙˆØ§Ø­ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø¨ÙŠÙ† 50% Ùˆ 100%.", false); return; }
                        if (isNaN(inverterEfficiency) || inverterEfficiency <= 0 || inverterEfficiency > 1) { displayResult("solar-panels-result", "ÙƒÙØ§Ø¡Ø© Ø§Ù„Ù…Ø­ÙˆÙ„ ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† Ø¨ÙŠÙ† 50% Ùˆ 100%.", false); return; }
                        if (isNaN(idealSeriesVoltage) || idealSeriesVoltage <= 0) { displayResult("solar-panels-result", "Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„ØªÙˆØªØ± Ø§Ù„Ù…Ø«Ø§Ù„ÙŠ Ù„Ù„Ø£Ù„ÙˆØ§Ø­ Ø¹Ù„Ù‰ Ø§Ù„ØªÙˆØ§Ù„ÙŠ ØµØ­ÙŠØ­ ÙˆÙ…ÙˆØ¬Ø¨.", false); return; }

                        const pumpRealPowerWatts = pumpPowerKw * 1000;

                        let actualPumpCurrentAC;
                        const sqrt3 = Math.sqrt(3);
                        if (pumpPhase === "single") {
                            if (pumpVoltage * pumpPowerFactor === 0) {
                                displayResult("solar-panels-result", "Ø®Ø·Ø£: Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø­Ø³Ø§Ø¨ ØªÙŠØ§Ø± Ø§Ù„Ù…Ø¶Ø®Ø© (AC). Ø¬Ù‡Ø¯ Ø§Ù„Ù…Ø¶Ø®Ø© Ø£Ùˆ Ù…Ø¹Ø§Ù…Ù„ Ø§Ù„Ù‚Ø¯Ø±Ø© Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø£Ù† ÙŠÙƒÙˆÙ† ØµÙØ±Ù‹Ø§.", false); return;
                            }
                            actualPumpCurrentAC = pumpRealPowerWatts / (pumpVoltage * pumpPowerFactor);
                        } else {
                            if (sqrt3 * pumpVoltage * pumpPowerFactor === 0) {
                                displayResult("solar-panels-result", "Ø®Ø·Ø£: Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø­Ø³Ø§Ø¨ ØªÙŠØ§Ø± Ø§Ù„Ù…Ø¶Ø®Ø© (AC). Ø¬Ù‡Ø¯ Ø§Ù„Ù…Ø¶Ø®Ø© Ø£Ùˆ Ù…Ø¹Ø§Ù…Ù„ Ø§Ù„Ù‚Ø¯Ø±Ø© Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø£Ù† ÙŠÙƒÙˆÙ† ØµÙØ±Ù‹Ø§ Ù„Ù„Ø·ÙˆØ± Ø§Ù„Ø«Ù„Ø§Ø«ÙŠ.", false); return;
                            }
                            actualPumpCurrentAC = pumpRealPowerWatts / (sqrt3 * pumpVoltage * pumpPowerFactor);
                        }

                        const nominalPanelPower = panelVoltage * panelCurrent;
                        if (nominalPanelPower === 0) {
                            displayResult("solar-panels-result", "Ø®Ø·Ø£: Ù‚Ø¯Ø±Ø© Ø§Ù„Ù„ÙˆØ­ Ø§Ù„Ø´Ù…Ø³ÙŠ Ø§Ù„Ø§Ø³Ù…ÙŠØ© Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø£Ù† ØªÙƒÙˆÙ† ØµÙØ±Ù‹Ø§. Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¬Ù‡Ø¯ ÙˆØªÙŠØ§Ø± Ø§Ù„Ù„ÙˆØ­.", false);
                            return;
                        }

                        if (inverterEfficiency * solarPerformanceFactor === 0) {
                            displayResult("solar-panels-result", "Ø®Ø·Ø£: ÙƒÙØ§Ø¡Ø© Ø§Ù„Ù…Ø­ÙˆÙ„ Ø£Ùˆ Ø¹Ø§Ù…Ù„ Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø£Ù„ÙˆØ§Ø­ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø£Ù† ÙŠÙƒÙˆÙ† ØµÙØ±Ù‹Ø§ Ù„Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„ÙƒÙ„ÙŠ.", false);
                            return;
                        }
                        const totalRequiredDcPowerAfterLosses = pumpRealPowerWatts / (inverterEfficiency * solarPerformanceFactor);

                        const totalPanelsNeeded = Math.ceil(totalRequiredDcPowerAfterLosses / nominalPanelPower);

                        if (panelVoltage === 0) {
                            displayResult("solar-panels-result", "Ø®Ø·Ø£: Ø¬Ù‡Ø¯ Ø§Ù„Ù„ÙˆØ­ Ø§Ù„ÙˆØ§Ø­Ø¯ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø£Ù† ÙŠÙƒÙˆÙ† ØµÙØ±Ù‹Ø§ Ù„Ø­Ø³Ø§Ø¨ Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ù„ÙˆØ§Ø­ ÙÙŠ Ø§Ù„Ø³Ù„Ø³Ù„Ø©.", false);
                            return;
                        }
                        const panelsInSeries = Math.ceil(idealSeriesVoltage / panelVoltage);
                        if (panelsInSeries === 0) {
                               displayResult("solar-panels-result", "Ø®Ø·Ø£: Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ù„ÙˆØ§Ø­ ÙÙŠ Ø§Ù„Ø³Ù„Ø³Ù„Ø© Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø£Ù† ÙŠÙƒÙˆÙ† ØµÙØ±Ù‹Ø§. ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ø¬Ù‡Ø¯ Ø§Ù„Ù…Ø«Ø§Ù„ÙŠ Ù„Ù„Ø³Ù„Ø³Ù„Ø© Ø£ÙƒØ¨Ø± Ù…Ù† Ø¬Ù‡Ø¯ Ø§Ù„Ù„ÙˆØ­ Ø§Ù„ÙˆØ§Ø­Ø¯.", false);
                               return;
                        }

                        const parallelStrings = Math.ceil(totalPanelsNeeded / panelsInSeries);

                        const actualTotalPanelsInArray = panelsInSeries * parallelStrings;
                        const actualSystemVoltageDC = panelsInSeries * panelVoltage;
                        const actualSystemCurrentDC = parallelStrings * panelCurrent;
                        const actualSystemTotalPower = actualTotalPanelsInArray * nominalPanelPower;

                        const resultMessage = `
                        <h3>Ù‚Ø¯Ø±Ø© Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø´Ù…Ø³ÙŠ Ø§Ù„ÙØ¹Ù„ÙŠØ© Ø§Ù„Ù…Ø±ÙƒØ¨Ø©:</h3>
                            <ul>
                                <li><strong>Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„ÙØ¹Ù„ÙŠ Ø§Ù„ÙƒÙ„ÙŠ Ù„Ù„Ø£Ù„ÙˆØ§Ø­ ÙÙŠ Ø§Ù„Ù…ØµÙÙˆÙØ©:</strong> ${actualTotalPanelsInArray} Ù„ÙˆØ­</li>
                                <li><strong>Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ù„ÙˆØ§Ø­ ÙÙŠ Ø§Ù„Ø³Ù„Ø³Ù„Ø© Ø§Ù„ÙˆØ§Ø­Ø¯Ø© (Series):</strong> ${panelsInSeries} Ù„ÙˆØ­</li>
                                <li><strong>Ø¹Ø¯Ø¯ Ø§Ù„Ø³Ù„Ø§Ø³Ù„ Ø§Ù„Ù…ØªÙˆØ§Ø²ÙŠØ© (Parallel Strings):</strong> ${parallelStrings} Ø³Ù„Ø³Ù„Ø©</li>
                                <li><strong>Ø§Ù„Ø¬Ù‡Ø¯ Ø§Ù„ÙƒÙ„ÙŠ Ù„Ù„Ø³Ù„Ø³Ù„Ø© (Vmp_array):</strong> <strong>${actualSystemVoltageDC.toFixed(2)} V</strong></li>
                                <li><strong>Ø§Ù„ØªÙŠØ§Ø± Ø§Ù„ÙƒÙ„ÙŠ Ù„Ù„Ø³Ù„Ø§Ø³Ù„ (Imp_array):</strong> <strong>${actualSystemCurrentDC.toFixed(2)} A</strong></li>
                                <li><strong>Ø¬Ù‡Ø¯ Ø§Ù„Ù…Ø¶Ø®Ø© Ø§Ù„Ù…Ø¯Ø®Ù„:</strong> ${pumpVoltage} V</li>
                                <li><strong>ØªÙŠØ§Ø± Ø§Ù„Ù…Ø¶Ø®Ø© Ø§Ù„Ù…Ù‚Ø¯Ø± (AC):</strong> <strong>${actualPumpCurrentAC.toFixed(2)} A</strong> <small></small></li>
                                <li><strong>Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ù‚Ø¯Ø±Ø© Ø§Ù„Ø§Ø³Ù…ÙŠØ© Ø§Ù„ÙØ¹Ù„ÙŠØ© Ù„Ù„Ù†Ø¸Ø§Ù…:</strong> <strong>${actualSystemTotalPower.toFixed(2)} W</strong></li>
                            </ul>
                            <hr>
                            <h3>Ù…Ù„Ø®Øµ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª:</h3>
                            <ul>
                                <li><strong>Ø§Ù„Ù‚Ø¯Ø±Ø© Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ© Ù„Ù„Ù…Ø¶Ø®Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:</strong> ${pumpRealPowerWatts.toFixed(2)} W</li>
                                <li><strong>Ù‚Ø¯Ø±Ø© Ø§Ù„Ù„ÙˆØ­ Ø§Ù„ÙˆØ§Ø­Ø¯ Ø§Ù„Ø§Ø³Ù…ÙŠØ©:</strong> ${nominalPanelPower.toFixed(2)} W </li>
                                <li><strong>Ø¹Ø§Ù…Ù„ Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø£Ù„ÙˆØ§Ø­:</strong> ${solarPerformanceFactor * 100}%</li>
                                <li><strong>ÙƒÙØ§Ø¡Ø© Ø§Ù„Ù…Ø­ÙˆÙ„:</strong> ${inverterEfficiency * 100}%</li>
                                <li><strong>Ø§Ù„Ù‚Ø¯Ø±Ø© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù…Ù† Ø§Ù„Ø£Ù„ÙˆØ§Ø­ (DC) Ø¨Ø¹Ø¯ Ø§Ù„Ø®Ø³Ø§Ø¦Ø±:</strong> ${totalRequiredDcPowerAfterLosses.toFixed(2)} W</li>
                                <li><strong>Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù„Ù„Ø£Ù„ÙˆØ§Ø­ Ø§Ù„Ø´Ù…Ø³ÙŠØ© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:</strong> <span style="color: var(--success-color); font-size: 1.2em;">${totalPanelsNeeded} Ù„ÙˆØ­</span></li>
                                <li><strong>Ø§Ù„Ù‚Ø¯Ø±Ø© Ø§Ù„Ø§Ø³Ù…ÙŠØ© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ© Ù„Ù„Ø£Ù„ÙˆØ§Ø­ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© (Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰):</strong> ${totalPanelsNeeded * nominalPanelPower.toFixed(2)} W</li>
                            </ul>
                        `;
                        displayResult("solar-panels-result", resultMessage, true);

                        const dataToSave = {
                            inputs: {
                                pumpPowerKw: pumpPowerKw,
                                pumpVoltage: pumpVoltage,
                                pumpPhase: pumpPhase,
                                pumpPowerFactor: pumpPowerFactor,
                                panelVoltage: panelVoltage,
                                panelCurrent: panelCurrent,
                                solarPerformanceFactor: parseFloat(document.getElementById("solar-performance-factor").value),
                                inverterEfficiency: parseFloat(document.getElementById("inverter-efficiency").value),
                                idealSeriesVoltage: idealSeriesVoltage
                            }
                        };
                        saveCalculatorState("solar-panels-calculator", dataToSave);
                    },
                },

                "battery-calculator": {
                    calculate: function () {
                        const deviceType = document.getElementById("battery-device-type").value;
                        const deviceVoltage = parseFloat(document.getElementById("device-voltage").value);
                        const deviceCurrent = parseFloat(document.getElementById("device-current").value);
                        const operationDuration = parseFloat(document.getElementById("operation-duration").value);
                        const batteryVoltage = parseFloat(document.getElementById("battery-voltage").value);
                        const dod = parseFloat(document.getElementById("battery-dod").value) / 100;
                        const efficiency = parseFloat(document.getElementById("battery-efficiency").value) / 100;

                        const devicePhase = document.getElementById("battery-device-phase").value;
                        const devicePowerFactor = parseFloat(document.getElementById("battery-device-power-factor").value);
                        const inverterEfficiencyBattery = parseFloat(document.getElementById("inverter-efficiency-battery").value) / 100;

                        if (isNaN(deviceVoltage) || deviceVoltage <= 0) { displayResult("battery-result", "Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø¬Ù‡Ø¯ Ø¬Ù‡Ø§Ø² ØµØ­ÙŠØ­ ÙˆÙ…ÙˆØ¬Ø¨.", false); return; }
                        if (isNaN(deviceCurrent) || deviceCurrent <= 0) { displayResult("battery-result", "Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ ØªÙŠØ§Ø± Ø¬Ù‡Ø§Ø² ØµØ­ÙŠØ­ ÙˆÙ…ÙˆØ¬Ø¨.", false); return; }
                        if (isNaN(operationDuration) || operationDuration <= 0) { displayResult("battery-result", "Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¯Ø© ØªØ´ØºÙŠÙ„ ØµØ­ÙŠØ­Ø© ÙˆÙ…ÙˆØ¬Ø¨Ø©.", false); return; }
                        if (isNaN(batteryVoltage) || batteryVoltage <= 0) { displayResult("battery-result", "Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ ØªÙˆØªØ± Ø¨Ø·Ø§Ø±ÙŠØ© ØµØ­ÙŠØ­ ÙˆÙ…ÙˆØ¬Ø¨.", false); return; }
                        if (isNaN(dod) || dod <= 0 || dod > 1) { displayResult("battery-result", "Ø¹Ù…Ù‚ Ø§Ù„ØªÙØ±ÙŠØº Ø§Ù„Ø£Ù‚ØµÙ‰ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø¨ÙŠÙ† 10% Ùˆ 100%.", false); return; }
                        if (isNaN(efficiency) || efficiency <= 0 || efficiency > 1) { displayResult("battery-result", "ÙƒÙØ§Ø¡Ø© Ø§Ù„Ø¨Ø·Ø§Ø±ÙŠØ© ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† Ø¨ÙŠÙ† 50% Ùˆ 100%.", false); return; }

                        const sqrt3 = Math.sqrt(3);

                        let devicePowerWatts;
                        let energyRequiredFromBatteryWh_before_battery_losses;

                        if (deviceType === "dc") {
                            devicePowerWatts = deviceVoltage * deviceCurrent;
                            energyRequiredFromBatteryWh_before_battery_losses = devicePowerWatts * operationDuration;
                        } else {
                            if (isNaN(devicePowerFactor) || devicePowerFactor <= 0.1 || devicePowerFactor > 1) { displayResult("battery-result", "Ù…Ø¹Ø§Ù…Ù„ Ù‚Ø¯Ø±Ø© Ø§Ù„Ø¬Ù‡Ø§Ø² ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø¨ÙŠÙ† 0.1 Ùˆ 1.", false); return; }
                            if (isNaN(inverterEfficiencyBattery) || inverterEfficiencyBattery <= 0 || inverterEfficiencyBattery > 1) { displayResult("battery-result", "ÙƒÙØ§Ø¡Ø© Ø§Ù„Ù…Ø­ÙˆÙ„ ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† Ø¨ÙŠÙ† 50% Ùˆ 100%.", false); return; }

                            if (devicePhase === "single") {
                                devicePowerWatts = deviceVoltage * deviceCurrent * devicePowerFactor;
                            } else {
                                devicePowerWatts = sqrt3 * deviceVoltage * deviceCurrent * devicePowerFactor;
                            }

                            if (inverterEfficiencyBattery === 0) {
                                displayResult("battery-result", "Ø®Ø·Ø£: ÙƒÙØ§Ø¡Ø© Ø§Ù„Ù…Ø­ÙˆÙ„ Ù„Ù„Ø¨Ø·Ø§Ø±ÙŠØ© Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø£Ù† ØªÙƒÙˆÙ† ØµÙØ±Ù‹Ø§.", false); return;
                            }
                            energyRequiredFromBatteryWh_before_battery_losses = (devicePowerWatts * operationDuration) / inverterEfficiencyBattery;
                        }

                        let nominalBatteryWhCapacity = 0;
                        if (dod > 0 && efficiency > 0) {
                            nominalBatteryWhCapacity = energyRequiredFromBatteryWh_before_battery_losses / dod / efficiency;
                        } else {
                            displayResult("battery-result", "Ø®Ø·Ø£: Ø¹Ù…Ù‚ Ø§Ù„ØªÙØ±ÙŠØº Ø£Ùˆ ÙƒÙØ§Ø¡Ø© Ø§Ù„Ø¨Ø·Ø§Ø±ÙŠØ© Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø£Ù† ÙŠÙƒÙˆÙ† ØµÙØ±Ù‹Ø§.", false); return;
                        }

                        let nominalBatteryAhCapacity = 0;
                        if (batteryVoltage > 0) {
                            nominalBatteryAhCapacity = nominalBatteryWhCapacity / batteryVoltage;
                        } else {
                            displayResult("battery-result", "Ø®Ø·Ø£: ØªÙˆØªØ± Ø§Ù„Ø¨Ø·Ø§Ø±ÙŠØ© Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø£Ù† ÙŠÙƒÙˆÙ† ØµÙØ±Ù‹Ø§.", false); return;
                        }

                        const usableBatteryWhCapacity = nominalBatteryWhCapacity * dod;

                        let resultMessage = `
                            <h3>Ù…Ù„Ø®Øµ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª:</h3>
                            <ul>
                                <li><strong>Ù‚Ø¯Ø±Ø© Ø§Ù„Ø¬Ù‡Ø§Ø² Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©:</strong> <strong>${devicePowerWatts.toFixed(2)} W</strong></li>
                                <li><strong>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ø§Ù‚Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¬Ù‡Ø§Ø²:</strong> <strong>${(devicePowerWatts * operationDuration).toFixed(2)} Wh</strong></li>
                        `;

                        if (deviceType === "ac") {
                            resultMessage += `<li><strong>Ø§Ù„Ø·Ø§Ù‚Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù…Ù† Ø¬Ø§Ù†Ø¨ DC Ù…Ù† Ø§Ù„Ø¨Ø·Ø§Ø±ÙŠØ©:</strong> <strong>${energyRequiredFromBatteryWh_before_battery_losses.toFixed(2)} Wh</strong> (Ø¨Ø¹Ø¯ Ø¶ÙŠØ§Ø¹ Ø§Ù„Ù…Ø­ÙˆÙ„ Ø¨Ù†Ø³Ø¨Ø© ${((1 - inverterEfficiencyBattery) * 100).toFixed(1)}%)</li>`;
                        } else {
                            resultMessage += `<li><strong>Ø§Ù„Ø·Ø§Ù‚Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù…Ù† Ø§Ù„Ø¨Ø·Ø§Ø±ÙŠØ© (Ù†Ù‚Ø·Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ DC):</strong> <strong>${energyRequiredFromBatteryWh_before_battery_losses.toFixed(2)} Wh</strong></li>`;
                        }

                        resultMessage += `
                                <li><strong>Ø§Ù„Ø³Ø¹Ø© Ø§Ù„ÙØ¹Ù„ÙŠØ© Ù„Ù„Ø¨Ø·Ø§Ø±ÙŠØ© Ø§Ù„ØªÙŠ ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡Ø§ (Usable Capacity):</strong> <strong>${usableBatteryWhCapacity.toFixed(2)} Wh</strong> (Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø¹Ù…Ù‚ Ø§Ù„ØªÙØ±ÙŠØº ${dod * 100}%)</li>
                            </ul>
                            <h3>Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©:</h3>
                            <p><strong>Ø§Ù„Ø³Ø¹Ø© Ø§Ù„Ø§Ø³Ù…ÙŠØ© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù„Ø¨Ø·Ø§Ø±ÙŠØ©: <span style="color: var(--success-color); font-size: 1.2em;">${nominalBatteryAhCapacity.toFixed(2)} Ah</span></strong></p>
                            <p><strong>Ø§Ù„Ù‚Ø¯Ø±Ø© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ© Ù„Ù„Ø¨Ø·Ø§Ø±ÙŠØ© (Wh): <span style="color: var(--success-color); font-size: 1.1em;">${nominalBatteryWhCapacity.toFixed(2)} Wh</span></strong></p>
                        `;

                        displayResult("battery-result", resultMessage, true);

                        const dataToSave = {
                            inputs: {
                                deviceType: deviceType,
                                deviceVoltage: deviceVoltage,
                                deviceCurrent: deviceCurrent,
                                operationDuration: operationDuration,
                                batteryVoltage: batteryVoltage,
                                dod: parseFloat(document.getElementById("battery-dod").value),
                                efficiency: parseFloat(document.getElementById("battery-efficiency").value),
                                devicePhase: deviceType === 'ac' ? devicePhase : null,
                                devicePowerFactor: deviceType === 'ac' ? parseFloat(document.getElementById("battery-device-power-factor").value) : null,
                                inverterEfficiencyBattery: deviceType === 'ac' ? parseFloat(document.getElementById("inverter-efficiency-battery").value) : null
                            }
                        };
                        saveCalculatorState("battery-calculator", dataToSave);
                    },
                },

                "percentage-calculator": {
                    calculate: function () {
                        const originalNumber = parseFloat(document.getElementById("original-number").value);
                        const percentageValue = parseFloat(document.getElementById("percentage-value").value);

                        if (isNaN(originalNumber) || originalNumber < 0) { displayResult("percentage-result", "Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø¹Ø¯Ø¯ Ø£ØµÙ„ÙŠ ØµØ­ÙŠØ­ ÙˆÙ…ÙˆØ¬Ø¨.", false); return; }
                        if (isNaN(percentageValue) || percentageValue < 0 || percentageValue > 100) { displayResult("percentage-result", "Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø¦ÙˆÙŠØ© ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† Ø¨ÙŠÙ† 0 Ùˆ 100.", false); return; }

                        const calculatedValue = (originalNumber * percentageValue) / 100;
                        const addedValue = originalNumber + calculatedValue;
                        const subtractedValue = originalNumber - calculatedValue;

                        const resultMessage = `
                            <h3>Ù…Ù„Ø®Øµ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª:</h3>
                            <ul>
                                <li><strong>Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ø£ØµÙ„ÙŠ:</strong> ${originalNumber.toFixed(2)}</li>
                                <li><strong>Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø¦ÙˆÙŠØ© Ø§Ù„Ù…Ø¯Ø®Ù„Ø©:</strong> ${percentageValue.toFixed(2)}%</li>
                                <li><strong>Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø­Ø³ÙˆØ¨Ø© (${percentageValue.toFixed(2)}% Ù…Ù† ${originalNumber.toFixed(2)}):</strong> ${calculatedValue.toFixed(2)}</li>
                            </ul>
                            <hr>
                            <h3>Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ©:</h3>
                            <ul>
                                <li>Ø¥Ø°Ø§ Ø£Ø¶ÙÙ†Ø§ Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø¦ÙˆÙŠØ©: <strong><span style="color: var(--success-color); font-size: 1.2em;">${addedValue.toFixed(2)}</span></strong> ( ${originalNumber.toFixed(2)} + ${calculatedValue.toFixed(2)} )</li>
                                <li>Ø¥Ø°Ø§ Ø®ØµÙ…Ù†Ø§ Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø¦ÙˆÙŠØ©: <strong><span style="color: var(--success-color); font-size: 1.2em;">${subtractedValue.toFixed(2)}</span></strong> ( ${originalNumber.toFixed(2)} - ${calculatedValue.toFixed(2)} )</li>
                                <li>Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¦ÙˆÙŠØ© ÙÙ‚Ø·: <strong><span style="color: var(--success-color); font-size: 1.2em;">${calculatedValue.toFixed(2)}</span></strong></li>
                            </ul>
                        `;
                        displayResult("percentage-result", resultMessage, true);

                        const dataToSave = {
                            inputs: {
                                originalNumber: originalNumber,
                                percentageValue: percentageValue
                            }
                        };
                        saveCalculatorState("percentage-calculator", dataToSave);
                    },
                },

                "capacitor-calculator": {
                    calculate: function () {
                        const voltage = parseFloat(document.getElementById("cap-voltage").value);
                        const phase = document.getElementById("cap-phase").value;
                        const realPowerKW = parseFloat(document.getElementById("cap-real-power").value);
                        const currentPF = parseFloat(document.getElementById("cap-current-pf").value);
                        const desiredPF = parseFloat(document.getElementById("cap-desired-pf").value);
                        const frequency = parseFloat(document.getElementById("cap-frequency").value);

                        if (isNaN(voltage) || voltage <= 0) { displayResult("capacitor-result", "Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø¬Ù‡Ø¯ ØªØ´ØºÙŠÙ„ ØµØ­ÙŠØ­ ÙˆÙ…ÙˆØ¬Ø¨.", false); return; }
                        if (isNaN(realPowerKW) || realPowerKW <= 0) { displayResult("capacitor-result", "Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ù‚Ø¯Ø±Ø© Ø­Ù‚ÙŠÙ‚ÙŠØ© ØµØ­ÙŠØ­Ø© ÙˆÙ…ÙˆØ¬Ø¨Ø©.", false); return; }
                        if (isNaN(currentPF) || currentPF <= 0.1 || currentPF >= 1) { displayResult("capacitor-result", "Ù…Ø¹Ø§Ù…Ù„ Ø§Ù„Ù‚Ø¯Ø±Ø© Ø§Ù„Ø­Ø§Ù„ÙŠ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø¨ÙŠÙ† 0.1 Ùˆ 0.99.", false); return; }
                        if (isNaN(desiredPF) || desiredPF <= 0.1 || desiredPF >= 1) { displayResult("capacitor-result", "Ù…Ø¹Ø§Ù…Ù„ Ø§Ù„Ù‚Ø¯Ø±Ø© Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø¨ÙŠÙ† 0.1 Ùˆ 0.99. ÙˆÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø£ÙƒØ¨Ø± Ù…Ù† Ø§Ù„Ø­Ø§Ù„ÙŠ.", false); return; }
                        if (desiredPF <= currentPF) { displayResult("capacitor-result", "Ù…Ø¹Ø§Ù…Ù„ Ø§Ù„Ù‚Ø¯Ø±Ø© Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø£ÙƒØ¨Ø± Ù…Ù† Ù…Ø¹Ø§Ù…Ù„ Ø§Ù„Ù‚Ø¯Ø±Ø© Ø§Ù„Ø­Ø§Ù„ÙŠ Ù„ØªØ­Ø³ÙŠÙ†Ù‡.", false); return; }
                        if (isNaN(frequency) || frequency <= 0) { displayResult("capacitor-result", "Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ ØªØ±Ø¯Ø¯ ØµØ­ÙŠØ­ ÙˆÙ…ÙˆØ¬Ø¨.", false); return; }

                        const realPowerWatts = realPowerKW * 1000;

                        const angle1 = Math.acos(currentPF);
                        const angle2 = Math.acos(desiredPF);

                        const reactivePower1 = realPowerWatts * Math.tan(angle1);
                        const reactivePower2 = realPowerWatts * Math.tan(angle2);

                        const qCompensation = reactivePower1 - reactivePower2;

                        let resultMessage;

                        if (phase === "single") {
                            if (voltage === 0 || frequency === 0) {
                                displayResult("capacitor-result", "Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø­Ø³Ø§Ø¨ Ø§Ù„Ø³Ø¹Ø©. ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ø¬Ù‡Ø¯ ÙˆØ§Ù„ØªØ±Ø¯Ø¯ ØµØ­ÙŠØ­ÙŠÙ† ÙˆÙ…ÙˆØ¬Ø¨ÙŠÙ†.", false); return;
                            }
                            const capacitorValueFarads = qCompensation / (2 * Math.PI * frequency * Math.pow(voltage, 2));
                            const capacitorValueMicroFarads = capacitorValueFarads * 1e6;

                            resultMessage = `
                                <h3>Ù…Ù„Ø®Øµ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª:</h3>
                                <ul>
                                    <li><strong>Ø§Ù„Ù‚Ø¯Ø±Ø© Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ© (P):</strong> ${realPowerKW.toFixed(2)} kW</li>
                                    <li><strong>Ù…Ø¹Ø§Ù…Ù„ Ø§Ù„Ù‚Ø¯Ø±Ø© Ø§Ù„Ø­Ø§Ù„ÙŠ (cos Ï†<sub>1</sub>):</strong> ${currentPF.toFixed(2)} (Ø²Ø§ÙˆÙŠØ© Ï†<sub>1</sub>: ${(angle1 * 180 / Math.PI).toFixed(2)}&deg;)</li>
                                    <li><strong>Ù…Ø¹Ø§Ù…Ù„ Ø§Ù„Ù‚Ø¯Ø±Ø© Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù (cos Ï†<sub>2</sub>):</strong> ${desiredPF.toFixed(2)} (Ø²Ø§ÙˆÙŠØ© Ï†<sub>2</sub>: ${(angle2 * 180 / Math.PI).toFixed(2)}&deg;)</li>
                                    <li><strong>Ø§Ù„ØªØ±Ø¯Ø¯ (f):</strong> ${frequency.toFixed(0)} Hz</li>
                                    <li><strong>Ø§Ù„Ø¬Ù‡Ø¯ (V):</strong> ${voltage.toFixed(0)} V</li>
                                </ul>
                                <h4>Ø§Ù„Ù‚Ø¯Ø±Ø© Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù„ØªØ¹ÙˆÙŠØ¶ (Qc):</h4>
                                <p>
                                    Ø§Ù„Ù‚Ø¯Ø±Ø© Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ© Ø§Ù„Ø­Ø§Ù„ÙŠØ© (Q<sub>1</sub>) = ${reactivePower1.toFixed(2)} Var<br>
                                    Ø§Ù„Ù‚Ø¯Ø±Ø© Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ© Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØ© (Q<sub>2</sub>) = ${reactivePower2.toFixed(2)} Var<br>
                                    ÙØ±Ù‚ Ø§Ù„Ù‚Ø¯Ø±Ø© Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ© (Qc) = Q<sub>1</sub> - Q<sub>2</sub> = <strong>${qCompensation.toFixed(2)} Var</strong>
                                </p>
                                <h3>Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©:</h3>
                                <p>Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ù†Ø¸Ø§Ù… <strong>Ø£Ø­Ø§Ø¯ÙŠ Ø§Ù„Ø·ÙˆØ±</strong>:</p>
                                <p><strong>Ø§Ù„Ø³Ø¹Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù„Ù…ÙƒØ«Ù: <span style="color: var(--success-color); font-size: 1.2em;">${capacitorValueMicroFarads.toFixed(2)} ÂµF</span></strong></p>
                                <p><small>Ù…Ù„Ø§Ø­Ø¸Ø©: Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø­Ø³ÙˆØ¨Ø© Ù‡ÙŠ Ù„Ù…ÙƒØ«Ù ÙˆØ§Ø­Ø¯.</small></p>
                            `;
                        } else {
                            if (voltage === 0 || frequency === 0) {
                                displayResult("capacitor-result", "Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø­Ø³Ø§Ø¨ Ø§Ù„Ø³Ø¹Ø©. ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ø¬Ù‡Ø¯ ÙˆØ§Ù„ØªØ±Ø¯Ø¯ ØµØ­ÙŠØ­ÙŠÙ† ÙˆÙ…ÙˆØ¬Ø¨ÙŠÙ†.", false); return;
                            }
                            const C_delta_per_phase_farads = qCompensation / (3 * 2 * Math.PI * frequency * Math.pow(voltage, 2));
                            const C_delta_per_phase_microFarads = C_delta_per_phase_farads * 1e6;

                            const V_phase = voltage / Math.sqrt(3);
                            if (V_phase === 0) {
                                displayResult("capacitor-result", "Ø®Ø·Ø£ ÙÙŠ Ø­Ø³Ø§Ø¨ Ø¬Ù‡Ø¯ Ø§Ù„Ø·ÙˆØ±. ØªØ£ÙƒØ¯ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø¬Ù‡Ø¯ Ø§Ù„Ù…Ø¯Ø®Ù„.", false); return;
                            }
                            const C_star_per_phase_farads = qCompensation / (3 * 2 * Math.PI * frequency * Math.pow(V_phase, 2));
                            const C_star_per_phase_microFarads = C_star_per_phase_farads * 1e6;

                            resultMessage = `
                                <h3>Ù…Ù„Ø®Øµ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª:</h3>
                                <ul>
                                    <li><strong>Ø§Ù„Ù‚Ø¯Ø±Ø© Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ© (P):</strong> ${realPowerKW.toFixed(2)} kW</li>
                                    <li><strong>Ù…Ø¹Ø§Ù…Ù„ Ø§Ù„Ù‚Ø¯Ø±Ø© Ø§Ù„Ø­Ø§Ù„ÙŠ (cos Ï†<sub>1</sub>):</strong> ${currentPF.toFixed(2)} (Ø²Ø§ÙˆÙŠØ© Ï†<sub>1</sub>: ${(angle1 * 180 / Math.PI).toFixed(2)}&deg;)</li>
                                    <li><strong>Ù…Ø¹Ø§Ù…Ù„ Ø§Ù„Ù‚Ø¯Ø±Ø© Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù (cos Ï†<sub>2</sub>):</strong> ${desiredPF.toFixed(2)} (Ø²Ø§ÙˆÙŠØ© Ï†<sub>2</sub>: ${(angle2 * 180 / Math.PI).toFixed(2)}&deg;)</li>
                                    <li><strong>Ø§Ù„ØªØ±Ø¯Ø¯ (f):</strong> ${frequency.toFixed(0)} Hz</li>
                                    <li><strong>Ø¬Ù‡Ø¯ Ø§Ù„Ø®Ø· (V<sub>L</sub>):</strong> ${voltage.toFixed(0)} V</li>
                                </ul>
                                <h4>Ø§Ù„Ù‚Ø¯Ø±Ø© Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù„ØªØ¹ÙˆÙŠØ¶ (Qc):</h4>
                                <p>
                                    Ø§Ù„Ù‚Ø¯Ø±Ø© Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ© Ø§Ù„Ø­Ø§Ù„ÙŠØ© (Q<sub>1</sub>) = ${reactivePower1.toFixed(2)} Var<br>
                                    Ø§Ù„Ù‚Ø¯Ø±Ø© Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ© Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØ© (Q<sub>2</sub>) = ${reactivePower2.toFixed(2)} Var<br>
                                    ÙØ±Ù‚ Ø§Ù„Ù‚Ø¯Ø±Ø© Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ© (Qc) = Q<sub>1</sub> - Q<sub>2</sub> = <strong>${qCompensation.toFixed(2)} Var</strong>
                                </p>
                                <h3>Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©:</h3>
                                <p>Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ù†Ø¸Ø§Ù… <strong>Ø«Ù„Ø§Ø«ÙŠ Ø§Ù„Ø·ÙˆØ±</strong>:</p>
                                <p>Ù„ØªØ­Ù‚ÙŠÙ‚ ØªØ­Ø³ÙŠÙ† Ù…Ø¹Ø§Ù…Ù„ Ø§Ù„Ù‚Ø¯Ø±Ø©ØŒ Ø³ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø¥Ø¬Ù…Ø§Ù„ÙŠ <strong>${qCompensation.toFixed(2)} Var</strong> Ù…Ù† Ø§Ù„Ù‚Ø¯Ø±Ø© Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ©.</p>
                                <h4>Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„ØªÙˆØµÙŠÙ„ (Ù„ÙƒÙ„ Ø·ÙˆØ±):</h4>
                                <ul>
                                    <li><strong>Ù„Ù„ØªÙˆØµÙŠÙ„ Ø¯Ù„ØªØ§ (Î”):</strong> ÙƒÙ„ Ù…ÙƒØ«Ù ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† Ø³Ø¹ØªÙ‡ <strong>${C_delta_per_phase_microFarads.toFixed(2)} ÂµF</strong>.<br>
                                        <small>(Ø«Ù„Ø§Ø« Ù…ÙƒØ«ÙØ§Øª Ù…ØªØµÙ„Ø© Ø¨ÙŠÙ† Ø§Ù„Ø®Ø·ÙˆØ·ØŒ Ø¬Ù‡Ø¯ ÙƒÙ„ Ù…ÙƒØ«Ù = Ø¬Ù‡Ø¯ Ø§Ù„Ø®Ø· ${voltage.toFixed(0)}V)</small></li>
                                    <li><strong>Ù„Ù„ØªÙˆØµÙŠÙ„ Ø³ØªØ§Ø± (Y):</strong> ÙƒÙ„ Ù…ÙƒØ«Ù ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† Ø³Ø¹ØªÙ‡ <strong>${C_star_per_phase_microFarads.toFixed(2)} ÂµF</strong>.<br>
                                        <small>(Ø«Ù„Ø§Ø« Ù…ÙƒØ«ÙØ§Øª Ù…ØªØµÙ„Ø© Ø¨ÙŠÙ† Ø§Ù„Ø®Ø·ÙˆØ· ÙˆÙ†Ù‚Ø·Ø© Ø§Ù„Ù†Ø¬Ù…Ø©ØŒ Ø¬Ù‡Ø¯ ÙƒÙ„ Ù…ÙƒØ«Ù = Ø¬Ù‡Ø¯ Ø§Ù„Ø·ÙˆØ± ${V_phase.toFixed(0)}V)</small></li>
                                </ul>
                                <p><small>Ù…Ù„Ø§Ø­Ø¸Ø©: ØªÙˆØµÙŠÙ„ Ø¯Ù„ØªØ§ Ù‡Ùˆ Ø§Ù„Ø£ÙƒØ«Ø± Ø´ÙŠÙˆØ¹Ø§Ù‹ Ù„ØªØ­Ø³ÙŠÙ† Ù…Ø¹Ø§Ù…Ù„ Ø§Ù„Ù‚Ø¯Ø±Ø© ÙÙŠ Ø§Ù„Ø£Ø­Ù…Ø§Ù„ Ø§Ù„ØµÙ†Ø§Ø¹ÙŠØ©.</small></p>
                            `;
                        }

                        displayResult("capacitor-result", resultMessage, true);

                        const dataToSave = {
                            inputs: {
                                voltage: voltage,
                                phase: phase,
                                realPowerKW: realPowerKW,
                                currentPF: currentPF,
                                desiredPF: desiredPF,
                                frequency: frequency
                            }
                        };
                        saveCalculatorState("capacitor-calculator", dataToSave);
                    },
                },

                "flow-converter": {
                    calculate: function () {
                        const inputValue = parseFloat(document.getElementById("flow-input-value").value);
                        const conversionType = document.getElementById("flow-conversion-type").value;

                        if (isNaN(inputValue) || inputValue < 0) { displayResult("flow-result", "Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ù‚ÙŠÙ…Ø© ØµØ­ÙŠØ­Ø© ÙˆÙ…ÙˆØ¬Ø¨Ø© Ù„Ù„ØªØ­ÙˆÙŠÙ„.", false); return; }

                        let result = 0;
                        let unitFrom = "";
                        let unitTo = "";
                        let explanation = "";

                        if (conversionType === "m3h-to-lps") {
                            result = (inputValue * 1000) / 3600;
                            unitFrom = "Ù…Â³/Ø³Ø§Ø¹Ø©";
                            unitTo = "Ù„ØªØ±/Ø«Ø§Ù†ÙŠØ©";
                            explanation = " (Ø¨Ø¶Ø±Ø¨ Ø§Ù„Ù‚ÙŠÙ…Ø© ÙÙŠ 1000 Ù„Ù„ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ Ù„ØªØ±ØŒ Ø«Ù… Ø§Ù„Ù‚Ø³Ù…Ø© Ø¹Ù„Ù‰ 3600 Ù„Ù„ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ Ø«Ø§Ù†ÙŠØ©)";
                        } else {
                            result = (inputValue * 3600) / 1000;
                            unitFrom = "Ù„ØªØ±/Ø«Ø§Ù†ÙŠØ©";
                            unitTo = "Ù…Â³/Ø³Ø§Ø¹Ø©";
                            explanation = " (Ø¨Ø¶Ø±Ø¨ Ø§Ù„Ù‚ÙŠÙ…Ø© ÙÙŠ 3600 Ù„Ù„ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ Ø³Ø§Ø¹Ø©ØŒ Ø«Ù… Ø§Ù„Ù‚Ø³Ù…Ø© Ø¹Ù„Ù‰ 1000 Ù„Ù„ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ Ù…ØªØ± Ù…ÙƒØ¹Ø¨)";
                        }

                        const resultMessage = `
                            <h3>Ù…Ù„Ø®Øµ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª:</h3>
                            <ul>
                                <li><strong>Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¯Ø®Ù„Ø©:</strong> ${inputValue.toFixed(2)} ${unitFrom}</li>
                                <li><strong>Ù†ÙˆØ¹ Ø§Ù„ØªØ­ÙˆÙŠÙ„:</strong> Ù…Ù† ${unitFrom} Ø¥Ù„Ù‰ ${unitTo}</li>
                            </ul>
                            <h3>Ø§Ù„Ù†ØªÙŠØ¬Ø©: <strong><span style="color: var(--success-color); font-size: 1.2em;">${result.toFixed(2)} ${unitTo}</span></strong></h3>
                            <p><small>ÙƒÙŠÙ ØªÙ… Ø§Ù„Ø­Ø³Ø§Ø¨: ${explanation}</small></p>
                        `;
                        displayResult("flow-result", resultMessage, true);

                        const dataToSave = {
                            inputs: {
                                inputValue: inputValue,
                                conversionType: conversionType
                            }
                        };
                        saveCalculatorState("flow-converter", dataToSave);
                    },
                },

                "tank-calculator": {
                    calculate: function () {
                        const tankShape = document.getElementById("tank-shape").value;
                        const lengthOrDiameter = parseFloat(document.getElementById("tank-length").value);
                        const width = parseFloat(document.getElementById("tank-width").value);
                        const height = parseFloat(document.getElementById("tank-height").value);
                        const flowRateM3H = parseFloat(document.getElementById("tank-flow-rate").value);

                        if (isNaN(lengthOrDiameter) || lengthOrDiameter <= 0) { displayResult("tank-result", "Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ù‚ÙŠÙ…Ø© ØµØ­ÙŠØ­Ø© ÙˆÙ…ÙˆØ¬Ø¨Ø© Ù„Ù„Ø·ÙˆÙ„ Ø£Ùˆ Ø§Ù„Ù‚Ø·Ø±.", false); return; }
                        if (isNaN(height) || height <= 0) { displayResult("tank-result", "Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ù‚ÙŠÙ…Ø© ØµØ­ÙŠØ­Ø© ÙˆÙ…ÙˆØ¬Ø¨Ø© Ù„Ù„Ø§Ø±ØªÙØ§Ø¹.", false); return; }
                        if (isNaN(flowRateM3H) || flowRateM3H <= 0) { displayResult("tank-result", "Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¹Ø¯Ù„ ØªØ¯ÙÙ‚ ØµØ­ÙŠØ­ ÙˆÙ…ÙˆØ¬Ø¨.", false); return; }

                        let volume = 0;

                        if (tankShape === "cube") {
                            if (isNaN(width) || width <= 0) { displayResult("tank-result", "Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ù‚ÙŠÙ…Ø© ØµØ­ÙŠØ­Ø© ÙˆÙ…ÙˆØ¬Ø¨Ø© Ù„Ù„Ø¹Ø±Ø¶ Ù„Ù„Ø®Ø²Ø§Ù† Ø§Ù„Ù…ÙƒØ¹Ø¨.", false); return; }
                            volume = lengthOrDiameter * width * height;
                        } else {
                            volume = Math.PI * Math.pow(lengthOrDiameter / 2, 2) * height;
                        }

                        if (volume === 0) {
                            displayResult("tank-result", "Ø®Ø·Ø£ ÙÙŠ Ø­Ø³Ø§Ø¨ Ø³Ø¹Ø© Ø§Ù„Ø®Ø²Ø§Ù†. ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ ØµØ­ÙŠØ­Ø© ÙˆÙ…ÙˆØ¬Ø¨Ø©.", false); return;
                        }
                        const timeToEmptyHours = volume / flowRateM3H;
                        const timeToEmptyMinutes = timeToEmptyHours * 60;

                        const resultMessage = `
                            <h3>Ù…Ù„Ø®Øµ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª:</h3>
                            <ul>
                                <li><strong>Ø´ÙƒÙ„ Ø§Ù„Ø®Ø²Ø§Ù†:</strong> ${tankShape === 'cube' ? 'Ù…ÙƒØ¹Ø¨' : 'Ø£Ø³Ø·ÙˆØ§Ù†ÙŠ'}</li>
                                <li><strong>Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯:</strong> ${lengthOrDiameter.toFixed(2)} Ù… (Ø§Ù„Ø·ÙˆÙ„/Ø§Ù„Ù‚Ø·Ø±) ${tankShape === 'cube' ? ' x ' + width.toFixed(2) + ' Ù… (Ø§Ù„Ø¹Ø±Ø¶)' : ''} x ${height.toFixed(2)} Ù… (Ø§Ù„Ø§Ø±ØªÙØ§Ø¹)</li>
                                <li><strong>Ù…Ø¹Ø¯Ù„ Ø§Ù„ØªØ¯ÙÙ‚:</strong> ${flowRateM3H.toFixed(2)} Ù…ØªØ± Ù…ÙƒØ¹Ø¨/Ø³Ø§Ø¹Ø©</li>
                            </ul>
                            <h3>Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©:</h3>
                            <ul>
                                <li><strong>Ø§Ù„Ø³Ø¹Ø© Ø§Ù„ÙƒÙ„ÙŠØ© Ù„Ù„Ø®Ø²Ø§Ù†: <span style="color: var(--success-color); font-size: 1.2em;">${volume.toFixed(2)} Ù…ØªØ± Ù…ÙƒØ¹Ø¨ (Ù…Â³)</span></strong></li>
                                <li><strong>Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù„Ø§Ø²Ù… Ù„ØªÙØ±ÙŠØº Ø§Ù„Ø®Ø²Ø§Ù†: <span style="color: var(--success-color); font-size: 1.2em;">${timeToEmptyMinutes.toFixed(2)} Ø¯Ù‚ÙŠÙ‚Ø©</span></strong></li>
                            </ul>
                            <p><small>Ù…Ù„Ø§Ø­Ø¸Ø©: 1 Ù…ØªØ± Ù…ÙƒØ¹Ø¨ ÙŠØ¹Ø§Ø¯Ù„ 1000 Ù„ØªØ±. Ù‡Ø°Ø§ Ø§Ù„Ø­Ø³Ø§Ø¨ ÙŠÙØªØ±Ø¶ ØªØ¯ÙÙ‚Ù‹Ø§ Ø«Ø§Ø¨ØªÙ‹Ø§.</small></p>
                        `;

                        displayResult("tank-result", resultMessage, true);
                        const dataToSave = {
                            inputs: {
                                tankShape: tankShape,
                                lengthOrDiameter: lengthOrDiameter,
                                width: width,
                                height: height,
                                flowRateM3H: flowRateM3H
                            }
                        };
                        saveCalculatorState("tank-calculator", dataToSave);
                    },
                },

                "resistance-voltage-drop": {
                    calculate: function () {
                        const voltage = parseFloat(document.getElementById("rvd-voltage").value);
                        const current = parseFloat(document.getElementById("rvd-current").value);
                        const phase = document.getElementById("rvd-phase").value;
                        const powerFactor = parseFloat(document.getElementById("rvd-power-factor").value);
                        const material = document.getElementById("rvd-material").value;
                        const length = parseFloat(document.getElementById("rvd-length").value);
                        const allowedVoltageDropPercentage = parseFloat(document.getElementById("rvd-allowed-voltage-drop-percentage").value);

                        let resistivity;
                        let materialName = "";
                        if (material === "copper") {
                            resistivity = 0.0172;
                            materialName = "Ø§Ù„Ù†Ø­Ø§Ø³ (0.0172 Î©Â·mmÂ²/m)";
                        } else {
                            resistivity = 0.0282;
                            materialName = "Ø§Ù„Ø£Ù„Ù…Ù†ÙŠÙˆÙ… (0.0282 Î©Â·mmÂ²/m)";
                        }

                        if (isNaN(voltage) || voltage <= 0) { displayResult("rvd-result", "Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø¬Ù‡Ø¯ ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠ ØµØ­ÙŠØ­ ÙˆÙ…ÙˆØ¬Ø¨.", false); return; }
                        if (isNaN(current) || current <= 0) { displayResult("rvd-result", "Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ ØªÙŠØ§Ø± ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠ ØµØ­ÙŠØ­ ÙˆÙ…ÙˆØ¬Ø¨.", false); return; }
                        if (isNaN(length) || length <= 0) { displayResult("rvd-result", "Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø·ÙˆÙ„ Ù…ÙˆØµÙ„ ØµØ­ÙŠØ­ ÙˆÙ…ÙˆØ¬Ø¨.", false); return; }
                        if (isNaN(allowedVoltageDropPercentage) || allowedVoltageDropPercentage <= 0 || allowedVoltageDropPercentage > 100) { displayResult("rvd-result", "Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù„ÙÙ‚Ø¯ Ø§Ù„Ø¬Ù‡Ø¯ Ø§Ù„Ù…Ø³Ù…ÙˆØ­ Ø¨Ù‡ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø¨ÙŠÙ† 0.1% Ùˆ 100%.", false); return; }
                        if (isNaN(powerFactor) || powerFactor <= 0.1 || powerFactor > 1) { displayResult("rvd-result", "Ù…Ø¹Ø§Ù…Ù„ Ø§Ù„Ù‚Ø¯Ø±Ø© ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø¨ÙŠÙ† 0.1 Ùˆ 1.", false); return; }

                        const maxAllowedVoltageDrop = (allowedVoltageDropPercentage / 100) * voltage;

                        if (current === 0 || maxAllowedVoltageDrop === 0) {
                            displayResult("rvd-result", "Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø­Ø³Ø§Ø¨ Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ù…Ù‚Ø·Ø¹. ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„ØªÙŠØ§Ø± ÙˆØ§Ù„Ø¬Ù‡Ø¯ Ø§Ù„Ù…Ø³Ù…ÙˆØ­ Ø¨Ù‡ Ù„ÙÙ‚Ø¯ Ø§Ù„Ø¬Ù‡Ø¯ Ù…ÙˆØ¬Ø¨Ø§Ù† ÙˆØºÙŠØ± ØµÙØ±ÙŠÙŠÙ†.", false);
                            return;
                        }

                        let requiredArea;
                        if (phase === "single") {
                            requiredArea = (2 * resistivity * length * current * powerFactor) / maxAllowedVoltageDrop;
                        } else {
                            requiredArea = (Math.sqrt(3) * resistivity * length * current * powerFactor) / maxAllowedVoltageDrop;
                        }

                        if (isNaN(requiredArea) || requiredArea <= 0 || !isFinite(requiredArea)) {
                            displayResult("rvd-result", "Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø­Ø³Ø§Ø¨ Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ù…Ù‚Ø·Ø¹. ØªØ£ÙƒØ¯ Ù…Ù† ØµØ­Ø© Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª ÙˆØ£Ù† Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ù…Ù†Ø·Ù‚ÙŠØ© (ØªØ¬Ù†Ø¨ Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„ØµØºÙŠØ±Ø© Ø¬Ø¯Ø§Ù‹ Ø£Ùˆ Ø§Ù„ÙƒØ¨ÙŠØ±Ø© Ø¬Ø¯Ø§Ù‹).", false);
                            return;
                        }

                        let resultMessage = `
                            <h3>Ù…Ù„Ø®Øµ Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª:</h3>
                            <ul>
                                <li><strong>Ø§Ù„Ø¬Ù‡Ø¯ Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠ:</strong> ${voltage.toFixed(0)} V</li>
                                <li><strong>Ø§Ù„ØªÙŠØ§Ø± Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠ:</strong> ${current.toFixed(2)} A</li>
                                <li><strong>Ù†ÙˆØ¹ Ø§Ù„Ø·ÙˆØ±:</strong> ${phase === 'single' ? 'Ø£Ø­Ø§Ø¯ÙŠ' : 'Ø«Ù„Ø§Ø«ÙŠ'}</li>
                                <li><strong>Ù…Ø¹Ø§Ù…Ù„ Ø§Ù„Ù‚Ø¯Ø±Ø©:</strong> ${powerFactor.toFixed(2)}</li>
                                <li><strong>Ù…Ø§Ø¯Ø© Ø§Ù„Ù…ÙˆØµÙ„:</strong> ${materialName}</li>
                                <li><strong>Ø·ÙˆÙ„ Ø§Ù„Ù…ÙˆØµÙ„ (Ø§ØªØ¬Ø§Ù‡ ÙˆØ§Ø­Ø¯):</strong> ${length.toFixed(1)} Ù…ØªØ±</li>
                                <li><strong>Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù„ÙÙ‚Ø¯ Ø§Ù„Ø¬Ù‡Ø¯ Ø§Ù„Ù…Ø³Ù…ÙˆØ­ Ø¨Ù‡:</strong> ${allowedVoltageDropPercentage.toFixed(1)}%</li>
                            </ul>
                            <h3>Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©:</h3>
                            <ul>
                                <li>Ø§Ù„Ø¬Ù‡Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ø§Ù„Ù…Ø³Ù…ÙˆØ­ Ø¨ÙÙ‚Ø¯Ù‡: <strong>${maxAllowedVoltageDrop.toFixed(2)} V</strong></li>
                                <li><strong>Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ù…Ù‚Ø·Ø¹ Ø§Ù„Ø¹Ø±Ø¶ÙŠ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù„Ù…ÙˆØµÙ„: <span style="color: var(--success-color); font-size: 1.2em;">${requiredArea.toFixed(2)} mmÂ²</span></strong></li>
                            </ul>
                            <p><small>Ù…Ù„Ø§Ø­Ø¸Ø©: Ù‡Ø°Ø§ Ø§Ù„Ø­Ø³Ø§Ø¨ ÙŠÙˆÙØ± Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ Ù„Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ù…Ù‚Ø·Ø¹. ÙŠÙˆØµÙ‰ Ø¨Ø§Ø®ØªÙŠØ§Ø± Ù…Ù‚Ø·Ø¹ Ø¹Ø±Ø¶ÙŠ Ù‚ÙŠØ§Ø³ÙŠ Ø£ÙƒØ¨Ø± Ù‚Ù„ÙŠÙ„Ø§Ù‹ Ù„Ø¶Ù…Ø§Ù† Ø§Ù„Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø£Ù…Ø«Ù„.</small></p>
                        `;

                        displayResult("rvd-result", resultMessage, true);

                        const dataToSave = {
                            inputs: {
                                voltage: voltage,
                                current: current,
                                material: material,
                                length: length,
                                allowedVoltageDropPercentage: allowedVoltageDropPercentage,
                                phase: phase,
                                powerFactor: powerFactor
                            }
                        };
                        saveCalculatorState("resistance-voltage-drop", dataToSave);
                    },
                },

                "pulley-calculator": {
                    calculate: function () {
                        const d1 = parseFloat(document.getElementById("pulley-d1").value);
                        const rpm1 = parseFloat(document.getElementById("pulley-rpm1").value);
                        const d2 = parseFloat(document.getElementById("pulley-d2").value);
                        const rpm2 = parseFloat(document.getElementById("pulley-rpm2").value);

                        let knownInputsCount = 0;
                        if (!isNaN(d1) && d1 > 0) knownInputsCount++;
                        if (!isNaN(rpm1) && rpm1 > 0) knownInputsCount++;
                        if (!isNaN(d2) && d2 > 0) knownInputsCount++;
                        if (!isNaN(rpm2) && rpm2 > 0) knownInputsCount++;

                        if (knownInputsCount !== 3) {
                            displayResult("pulley-result", "Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø«Ù„Ø§Ø« Ù‚ÙŠÙ… Ù…Ø¹Ù„ÙˆÙ…Ø© ÙÙ‚Ø· (Ù…ÙˆØ¬Ø¨Ø© ÙˆØºÙŠØ± ØµÙØ±ÙŠØ©) ÙˆØªØ±Ùƒ Ø­Ù‚Ù„ ÙˆØ§Ø­Ø¯ ÙØ§Ø±ØºÙ‹Ø§ Ù„Ù„Ù…Ø¬Ù‡ÙˆÙ„.", false);
                            return;
                        }

                        let unknownValue;
                        let unknownType = "";
                        let resultMessage = "";

                        if (isNaN(d1) || d1 <= 0) {
                            if (rpm1 > 0 && d2 > 0 && rpm2 > 0) {
                                unknownValue = (d2 * rpm2) / rpm1;
                                unknownType = "Ù‚Ø·Ø± Ø§Ù„Ø¨ÙƒØ±Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ (D1)";
                                resultMessage = `
                                    <p><strong>Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ù…Ø¯Ø®Ù„Ø©:</strong> D2=${d2} Ù…Ù…, RPM1=${rpm1} RPM, RPM2=${rpm2} RPM</p>
                                    <h3>Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¬Ù‡ÙˆÙ„Ø©: <strong>${unknownType} = <span style="color: var(--success-color); font-size: 1.2em;">${unknownValue.toFixed(2)} Ù…Ù…</span></strong></h3>
                                    <p><small>Ù…Ø¹Ø§Ø¯Ù„Ø© Ø§Ù„Ø¨ÙƒØ±Ø§Øª: D1 Ã— RPM1 = D2 Ã— RPM2</small></p>
                                `;
                            }
                        } else if (isNaN(rpm1) || rpm1 <= 0) {
                            if (d1 > 0 && d2 > 0 && rpm2 > 0) {
                                unknownValue = (d2 * rpm2) / d1;
                                unknownType = "Ø³Ø±Ø¹Ø© Ø§Ù„Ø¨ÙƒØ±Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ (RPM1)";
                                resultMessage = `
                                    <p><strong>Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ù…Ø¯Ø®Ù„Ø©:</strong> D1=${d1} Ù…Ù…, D2=${d2} Ù…Ù…, RPM2=${rpm2} RPM</p>
                                    <h3>Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¬Ù‡ÙˆÙ„Ø©: <strong>${unknownType} = <span style="color: var(--success-color); font-size: 1.2em;">${unknownValue.toFixed(2)} RPM</span></strong></h3>
                                    <p><small>Ù…Ø¹Ø§Ø¯Ù„Ø© Ø§Ù„Ø¨ÙƒØ±Ø§Øª: D1 Ã— RPM1 = D2 Ã— RPM2</small></p>
                                `;
                            }
                        } else if (isNaN(d2) || d2 <= 0) {
                            if (d1 > 0 && rpm1 > 0 && rpm2 > 0) {
                                unknownValue = (d1 * rpm1) / rpm2;
                                unknownType = "Ù‚Ø·Ø± Ø§Ù„Ø¨ÙƒØ±Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ© (D2)";
                                resultMessage = `
                                    <p><strong>Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ù…Ø¯Ø®Ù„Ø©:</strong> D1=${d1} Ù…Ù…, RPM1=${rpm1} RPM, RPM2=${rpm2} RPM</p>
                                    <h3>Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¬Ù‡ÙˆÙ„Ø©: <strong>${unknownType} = <span style="color: var(--success-color); font-size: 1.2em;">${unknownValue.toFixed(2)} Ù…Ù…</span></strong></h3>
                                    <p><small>Ù…Ø¹Ø§Ø¯Ù„Ø© Ø§Ù„Ø¨ÙƒØ±Ø§Øª: D1 Ã— RPM1 = D2 Ã— RPM2</small></p>
                                `;
                            }
                        } else if (isNaN(rpm2) || rpm2 <= 0) {
                            if (d1 > 0 && rpm1 > 0 && d2 > 0) {
                                unknownValue = (d1 * rpm1) / d2;
                                unknownType = "Ø³Ø±Ø¹Ø© Ø§Ù„Ø¨ÙƒØ±Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ© (RPM2)";
                                resultMessage = `
                                    <p><strong>Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ù…Ø¯Ø®Ù„Ø©:</strong> D1=${d1} Ù…Ù…, RPM1=${rpm1} RPM, D2=${d2} Ù…Ù…</p>
                                    <h3>Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¬Ù‡ÙˆÙ„Ø©: <strong>${unknownType} = <span style="color: var(--success-color); font-size: 1.2em;">${unknownValue.toFixed(2)} RPM</span></strong></h3>
                                    <p><small>Ù…Ø¹Ø§Ø¯Ù„Ø© Ø§Ù„Ø¨ÙƒØ±Ø§Øª: D1 Ã— RPM1 = D2 Ã— RPM2</small></p>
                                `;
                            }
                        }

                        if (isNaN(unknownValue) || unknownValue <= 0 || !isFinite(unknownValue)) {
                            displayResult("pulley-result", "Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­Ø³Ø§Ø¨. ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¯Ø®Ø§Ù„ Ø«Ù„Ø§Ø« Ù‚ÙŠÙ… ØµØ­ÙŠØ­Ø© ÙˆÙ…ÙˆØ¬Ø¨Ø© ÙˆØªØ¬Ù†Ø¨ Ù‚Ø³Ù…Ø© Ø¹Ù„Ù‰ ØµÙØ±.", false);
                            return;
                        }

                        displayResult("pulley-result", resultMessage, true);

                        const dataToSave = {
                            inputs: {
                                d1: document.getElementById("pulley-d1").value === '' ? null : d1,
                                rpm1: document.getElementById("pulley-rpm1").value === '' ? null : rpm1,
                                d2: document.getElementById("pulley-d2").value === '' ? null : d2,
                                rpm2: document.getElementById("pulley-rpm2").value === '' ? null : rpm2
                            }
                        };
                        saveCalculatorState("pulley-calculator", dataToSave);
                    },
                }
            };

            sectionTitles.forEach(title => {
                title.addEventListener("click", function () {
                    const modalId = this.dataset.modalTarget;
                    const targetModal = document.getElementById(modalId);
                    const calculatorId = targetModal.querySelector('.calculator').id;

                    if (targetModal) {
                        targetModal.classList.add("active");
                        const inputsInModal = targetModal.querySelectorAll('input, select');
                        inputsInModal.forEach(input => {
                            input.classList.remove("error");
                        });
                        loadAndDisplayCalculatorState(calculatorId, targetModal);
                    }
                });
            });

            closeButtons.forEach(button => {
                button.addEventListener("click", function () {
                    const modal = this.closest(".modal");
                    if (modal) {
                        modal.classList.remove("active");
                    }
                });
            });

            modals.forEach(modal => {
                modal.addEventListener("click", function (event) {
                    if (event.target === modal) {
                        modal.classList.remove("active");
                    }
                });
            });

            document.querySelectorAll(".calculator button").forEach(button => {
                button.addEventListener("click", function () {
                    const calculatorId = this.closest(".calculator").id;
                    const originalText = this.innerHTML;

                    this.innerHTML = `<span class="loading"></span> ${originalText}`;
                    this.disabled = true;

                    const inputs = this.closest('.calculator').querySelectorAll('input[type="number"], select');
                    let allInputsValid = true;

                    inputs.forEach(input => {
                        if (input.type === 'number') {
                            if (calculatorId === 'pulley-calculator') {
                                if (input.value !== '' && (isNaN(parseFloat(input.value)) || parseFloat(input.value) <= 0)) {
                                    input.classList.add("error");
                                    allInputsValid = false;
                                } else {
                                    input.classList.remove("error");
                                }
                            } else {
                                const value = parseFloat(input.value);
                                const min = parseFloat(input.min);
                                const max = parseFloat(input.max);
                                if (isNaN(value) || (input.hasAttribute('min') && value < min) || (input.hasAttribute('max') && value > max)) {
                                    input.classList.add("error");
                                    allInputsValid = false;
                                } else {
                                    input.classList.remove("error");
                                }
                            }
                        } else if (input.checkValidity && !input.checkValidity()) {
                            input.classList.add("error");
                            allInputsValid = false;
                        } else {
                            input.classList.remove("error");
                        }
                    });

                    if (calculatorId === 'pulley-calculator') {
                        let emptyCount = 0;
                        inputs.forEach(input => {
                            if (input.id.startsWith('pulley-') && input.value === '') {
                                emptyCount++;
                            }
                        });
                        if (emptyCount !== 1) {
                            displayResult(this.closest('.calculator').querySelector('.result').id, "Ø§Ù„Ø±Ø¬Ø§Ø¡ ØªØ±Ùƒ Ø­Ù‚Ù„ ÙˆØ§Ø­Ø¯ ÙÙ‚Ø· ÙØ§Ø±ØºØ§Ù‹ Ù„Ù„Ù…Ø¬Ù‡ÙˆÙ„ ÙÙŠ Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø¨ÙƒØ±Ø©.", false);
                            allInputsValid = false;
                            inputs.forEach(input => {
                                if (input.value === '') {
                                    input.classList.add("error");
                                }
                            });
                        } else {
                            inputs.forEach(input => {
                                if (input.value === '') {
                                    input.classList.remove("error");
                                }
                            });
                        }
                    }

                    setTimeout(() => {
                        if (allInputsValid && calculatorFunctions[calculatorId]) {
                            calculatorFunctions[calculatorId].calculate();
                        } else if (!allInputsValid) {
                            displayResult(this.closest('.calculator').querySelector('.result').id, "Ø§Ù„Ø±Ø¬Ø§Ø¡ ØªØµØ­ÙŠØ­ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ ÙÙŠ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„Ø§Øª Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©.", false);
                        } else {
                            console.error(`Calculation function for ID '${calculatorId}' not found.`);
                        }
                        this.innerHTML = originalText;
                        this.disabled = false;
                    }, 300);
                });
            });

            document.querySelectorAll("input[type='number']").forEach(input => {
                input.addEventListener("input", function () {
                    this.classList.remove("error");

                    if (this.closest('.calculator').id === 'pulley-calculator' || (this.closest('.calculator').id === 'tank-calculator' && this.id === 'tank-width' && this.disabled)) {
                        return;
                    }

                    const value = parseFloat(this.value);
                    const min = parseFloat(this.min);
                    const max = parseFloat(this.max);
                    let isValid = true;

                    if (this.value === '') {
                        isValid = true;
                    } else if (isNaN(value)) {
                        isValid = false;
                    } else if (this.hasAttribute('min') && value < min) {
                        isValid = false;
                    } else if (this.hasAttribute('max') && value > max) {
                        isValid = false;
                    }

                    if (!isValid) {
                        this.classList.add("error");
                    } else {
                        this.classList.remove("error");
                    }
                });
            });

            const tankShapeSelect = document.getElementById('tank-shape');
            const tankWidthInput = document.getElementById('tank-width');
            const tankWidthGroup = document.getElementById('tank-width-group');
            
            if (tankShapeSelect && tankWidthInput && tankWidthGroup) {
                tankShapeSelect.addEventListener('change', function () {
                    if (this.value === 'cube') {
                        tankWidthGroup.style.display = 'flex';
                        tankWidthInput.disabled = false;
                        tankWidthInput.setAttribute('required', 'required');
                    } else {
                        tankWidthGroup.style.display = 'flex';
                        tankWidthInput.disabled = true;
                        tankWidthInput.removeAttribute('required');
                        tankWidthInput.classList.remove("error");
                    }
                });
                const event = new Event('change');
                tankShapeSelect.dispatchEvent(event);
            }

            const batteryDeviceTypeSelect = document.getElementById('battery-device-type');
            const batteryACFields = document.querySelectorAll('.battery-ac-only');

            if (batteryDeviceTypeSelect && batteryACFields.length > 0) {
                batteryDeviceTypeSelect.addEventListener('change', function () {
                    if (this.value === 'ac') {
                        batteryACFields.forEach(group => group.style.display = 'flex');
                        document.getElementById('battery-device-phase').setAttribute('required', 'required');
                        document.getElementById('battery-device-power-factor').setAttribute('required', 'required');
                        document.getElementById('inverter-efficiency-battery').setAttribute('required', 'required');
                    } else {
                        batteryACFields.forEach(group => {
                            group.style.display = 'none';
                            const input = group.querySelector('input, select');
                            if (input) {
                                if (input.id === 'battery-device-power-factor') {
                                    input.value = '0.8';
                                } else if (input.id === 'inverter-efficiency-battery') {
                                    input.value = '90';
                                } else if (input.id === 'battery-device-phase') {
                                    input.value = 'single';
                                } else {
                                    input.value = '';
                                }
                                input.classList.remove("error");
                                input.removeAttribute('required');
                            }
                        });
                    }
                });
                const event = new Event('change');
                batteryDeviceTypeSelect.dispatchEvent(event);
            }

            const defaultValues = {
                'unit-converter': {
                    'uc-power-factor': "0.8",
                    'uc-input-unit': "kw",
                    'uc-phase': "single"
                },
                'tank-calculator': {
                    'tank-shape': "cube"
                },
                'resistance-voltage-drop': {
                    'rvd-material': "copper",
                    'rvd-allowed-voltage-drop-percentage': "3",
                    'rvd-phase': "single",
                    'rvd-power-factor': "0.8"
                },
                'flow-converter': {
                    'flow-conversion-type': "m3h-to-lps"
                },
                'capacitor-calculator': {
                    'cap-current-pf': "0.7",
                    'cap-desired-pf': "0.95",
                    'cap-frequency': "50",
                    'cap-phase': "single"
                },
                'solar-panels-calculator': {
                    'solar-performance-factor': "80",
                    'inverter-efficiency': "90",
                    'pump-voltage': "230",
                    'pump-phase': "single",
                    'pump-power-factor': "0.8",
                    'ideal-series-voltage': ""
                },
                'battery-calculator': {
                    'battery-dod': "80",
                    'battery-efficiency': "90",
                    'battery-device-type': "dc",
                    'battery-device-phase': "single",
                    'battery-device-power-factor': "0.8",
                    'inverter-efficiency-battery': "90"
                },
                'pulley-calculator': {
                    'pulley-d1': "",
                    'pulley-rpm1': "",
                    'pulley-d2': "",
                    'pulley-rpm2': ""
                }
            };

            function loadAndDisplayCalculatorState(calculatorId, targetElement) {
                // console.log(`Loading and displaying state for ${calculatorId}`); // For debugging
                const resultElement = targetElement.querySelector('.result');

                const savedState = loadCalculatorState(calculatorId);
                if (savedState && savedState.inputs) {
                    // console.log('Found saved state, populating inputs...'); // For debugging
                    populateInputs(calculatorId, savedState.inputs, targetElement);
                } else {
                    // console.log('No saved state, applying defaults.'); // For debugging
                    const inputs = targetElement.querySelectorAll('input[type="number"], select');
                    inputs.forEach(input => {
                        const defaultValue = defaultValues[calculatorId] ? defaultValues[calculatorId][input.id] : undefined;
                        if (defaultValue !== undefined) {
                            input.value = defaultValue;
                        } else {
                            if (calculatorId === 'pulley-calculator' && (input.id === 'pulley-d1' || input.id === 'pulley-rpm1' || input.id === 'pulley-d2' || input.id === 'pulley-rpm2')) {
                                input.value = '';
                            } else {
                                input.value = "";
                            }
                        }
                        input.classList.remove("error");
                    });
                }

                if (resultElement) {
                    let initialResultText = "Ø§Ù„Ù†ØªØ§Ø¦Ø¬: ...";
                    if (calculatorId === 'percentage-calculator') {
                        initialResultText = "Ø§Ù„Ù†Ø§ØªØ¬: ...";
                    } else if (calculatorId === 'capacitor-calculator') {
                        initialResultText = "Ø§Ù„Ø³Ø¹Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©: ...";
                    } else if (calculatorId === 'flow-converter') {
                        initialResultText = "Ø§Ù„Ù†ØªÙŠØ¬Ø©: ...";
                    } else if (calculatorId === 'unit-converter') {
                        initialResultText = '<p>Ø§Ù„Ù†ØªØ§Ø¦Ø¬:</p><ul><li>kW: <span>...</span></li><li>kVA: <span>...</span></li><li>HP: <span>...</span></li><li>Ampere: <span>...</span></li></ul>';
                    } else if (calculatorId === 'battery-calculator') {
                        initialResultText = 'Ø§Ù„Ù†ØªØ§Ø¦Ø¬: ...';
                    }

                    resultElement.innerHTML = initialResultText;
                    resultElement.className = "result";
                }

                if (calculatorId === 'tank-calculator' && tankShapeSelect) {
                    const event = new Event('change');
                    tankShapeSelect.dispatchEvent(event);
                }
                if (calculatorId === 'battery-calculator' && batteryDeviceTypeSelect) {
                    const event = new Event('change');
                    batteryDeviceTypeSelect.dispatchEvent(event);
                }
            }
        });
    </script>

</body>
</html>
